{"ast":null,"code":"'use strict';\n\nvar Registry = require('../../registry');\nvar Lib = require('../../lib');\nvar colorscaleDefaults = require('../../components/colorscale/defaults');\nvar attributes = require('./attributes');\nvar MIN = 0.1; // Note: often we don't want the data cube to be disappeared\n\nfunction createWave(n, minOpacity) {\n  var arr = [];\n  var steps = 32; // Max: 256\n  for (var i = 0; i < steps; i++) {\n    var u = i / (steps - 1);\n    var v = minOpacity + (1 - minOpacity) * (1 - Math.pow(Math.sin(n * u * Math.PI), 2));\n    arr.push([u, Math.max(0, Math.min(1, v))]);\n  }\n  return arr;\n}\nfunction isValidScaleArray(scl) {\n  var highestVal = 0;\n  if (!Array.isArray(scl) || scl.length < 2) return false;\n  if (!scl[0] || !scl[scl.length - 1]) return false;\n  if (+scl[0][0] !== 0 || +scl[scl.length - 1][0] !== 1) return false;\n  for (var i = 0; i < scl.length; i++) {\n    var si = scl[i];\n    if (si.length !== 2 || +si[0] < highestVal) {\n      return false;\n    }\n    highestVal = +si[0];\n  }\n  return true;\n}\nfunction supplyDefaults(traceIn, traceOut, defaultColor, layout) {\n  var i, j;\n  function coerce(attr, dflt) {\n    return Lib.coerce(traceIn, traceOut, attributes, attr, dflt);\n  }\n  var x = coerce('x');\n  var y = coerce('y');\n  var z = coerce('z');\n  if (!z || !z.length || (x ? x.length < 1 : false) || (y ? y.length < 1 : false)) {\n    traceOut.visible = false;\n    return;\n  }\n  traceOut._xlength = Array.isArray(x) && Lib.isArrayOrTypedArray(x[0]) ? z.length : z[0].length;\n  traceOut._ylength = z.length;\n  var handleCalendarDefaults = Registry.getComponentMethod('calendars', 'handleTraceDefaults');\n  handleCalendarDefaults(traceIn, traceOut, ['x', 'y', 'z'], layout);\n  coerce('text');\n  coerce('hovertext');\n  coerce('hovertemplate');\n  coerce('xhoverformat');\n  coerce('yhoverformat');\n  coerce('zhoverformat');\n\n  // Coerce remaining properties\n  ['lighting.ambient', 'lighting.diffuse', 'lighting.specular', 'lighting.roughness', 'lighting.fresnel', 'lightposition.x', 'lightposition.y', 'lightposition.z', 'hidesurface', 'connectgaps', 'opacity'].forEach(function (x) {\n    coerce(x);\n  });\n  var surfaceColor = coerce('surfacecolor');\n  var dims = ['x', 'y', 'z'];\n  for (i = 0; i < 3; ++i) {\n    var contourDim = 'contours.' + dims[i];\n    var show = coerce(contourDim + '.show');\n    var highlight = coerce(contourDim + '.highlight');\n    if (show || highlight) {\n      for (j = 0; j < 3; ++j) {\n        coerce(contourDim + '.project.' + dims[j]);\n      }\n    }\n    if (show) {\n      coerce(contourDim + '.color');\n      coerce(contourDim + '.width');\n      coerce(contourDim + '.usecolormap');\n    }\n    if (highlight) {\n      coerce(contourDim + '.highlightcolor');\n      coerce(contourDim + '.highlightwidth');\n    }\n    coerce(contourDim + '.start');\n    coerce(contourDim + '.end');\n    coerce(contourDim + '.size');\n  }\n\n  // backward compatibility block\n  if (!surfaceColor) {\n    mapLegacy(traceIn, 'zmin', 'cmin');\n    mapLegacy(traceIn, 'zmax', 'cmax');\n    mapLegacy(traceIn, 'zauto', 'cauto');\n  }\n\n  // TODO if contours.?.usecolormap are false and hidesurface is true\n  // the colorbar shouldn't be shown by default\n\n  colorscaleDefaults(traceIn, traceOut, layout, coerce, {\n    prefix: '',\n    cLetter: 'c'\n  });\n  opacityscaleDefaults(traceIn, traceOut, layout, coerce);\n\n  // disable 1D transforms - currently surface does NOT support column data like heatmap does\n  // you can use mesh3d for this use case, but not surface\n  traceOut._length = null;\n}\nfunction opacityscaleDefaults(traceIn, traceOut, layout, coerce) {\n  var opacityscale = coerce('opacityscale');\n  if (opacityscale === 'max') {\n    traceOut.opacityscale = [[0, MIN], [1, 1]];\n  } else if (opacityscale === 'min') {\n    traceOut.opacityscale = [[0, 1], [1, MIN]];\n  } else if (opacityscale === 'extremes') {\n    traceOut.opacityscale = createWave(1, MIN);\n  } else if (!isValidScaleArray(opacityscale)) {\n    traceOut.opacityscale = undefined;\n  }\n}\nfunction mapLegacy(traceIn, oldAttr, newAttr) {\n  if (oldAttr in traceIn && !(newAttr in traceIn)) {\n    traceIn[newAttr] = traceIn[oldAttr];\n  }\n}\nmodule.exports = {\n  supplyDefaults: supplyDefaults,\n  opacityscaleDefaults: opacityscaleDefaults\n};","map":{"version":3,"names":["Registry","require","Lib","colorscaleDefaults","attributes","MIN","createWave","n","minOpacity","arr","steps","i","u","v","Math","pow","sin","PI","push","max","min","isValidScaleArray","scl","highestVal","Array","isArray","length","si","supplyDefaults","traceIn","traceOut","defaultColor","layout","j","coerce","attr","dflt","x","y","z","visible","_xlength","isArrayOrTypedArray","_ylength","handleCalendarDefaults","getComponentMethod","forEach","surfaceColor","dims","contourDim","show","highlight","mapLegacy","prefix","cLetter","opacityscaleDefaults","_length","opacityscale","undefined","oldAttr","newAttr","module","exports"],"sources":["E:/tog_workspace/TestFabric_main/TestFabric-main/node_modules/plotly.js/src/traces/surface/defaults.js"],"sourcesContent":["'use strict';\n\nvar Registry = require('../../registry');\nvar Lib = require('../../lib');\n\nvar colorscaleDefaults = require('../../components/colorscale/defaults');\nvar attributes = require('./attributes');\n\nvar MIN = 0.1; // Note: often we don't want the data cube to be disappeared\n\nfunction createWave(n, minOpacity) {\n    var arr = [];\n    var steps = 32; // Max: 256\n    for(var i = 0; i < steps; i++) {\n        var u = i / (steps - 1);\n        var v = minOpacity + (1 - minOpacity) * (1 - Math.pow(Math.sin(n * u * Math.PI), 2));\n        arr.push([\n            u,\n            Math.max(0, Math.min(1, v))\n        ]);\n    }\n    return arr;\n}\n\nfunction isValidScaleArray(scl) {\n    var highestVal = 0;\n\n    if(!Array.isArray(scl) || scl.length < 2) return false;\n\n    if(!scl[0] || !scl[scl.length - 1]) return false;\n\n    if(+scl[0][0] !== 0 || +scl[scl.length - 1][0] !== 1) return false;\n\n    for(var i = 0; i < scl.length; i++) {\n        var si = scl[i];\n\n        if(si.length !== 2 || +si[0] < highestVal) {\n            return false;\n        }\n\n        highestVal = +si[0];\n    }\n\n    return true;\n}\n\nfunction supplyDefaults(traceIn, traceOut, defaultColor, layout) {\n    var i, j;\n\n    function coerce(attr, dflt) {\n        return Lib.coerce(traceIn, traceOut, attributes, attr, dflt);\n    }\n\n    var x = coerce('x');\n    var y = coerce('y');\n\n    var z = coerce('z');\n    if(!z || !z.length ||\n       (x ? (x.length < 1) : false) ||\n       (y ? (y.length < 1) : false)\n    ) {\n        traceOut.visible = false;\n        return;\n    }\n\n    traceOut._xlength = (Array.isArray(x) && Lib.isArrayOrTypedArray(x[0])) ? z.length : z[0].length;\n    traceOut._ylength = z.length;\n\n    var handleCalendarDefaults = Registry.getComponentMethod('calendars', 'handleTraceDefaults');\n    handleCalendarDefaults(traceIn, traceOut, ['x', 'y', 'z'], layout);\n\n    coerce('text');\n    coerce('hovertext');\n    coerce('hovertemplate');\n    coerce('xhoverformat');\n    coerce('yhoverformat');\n    coerce('zhoverformat');\n\n    // Coerce remaining properties\n    [\n        'lighting.ambient',\n        'lighting.diffuse',\n        'lighting.specular',\n        'lighting.roughness',\n        'lighting.fresnel',\n        'lightposition.x',\n        'lightposition.y',\n        'lightposition.z',\n        'hidesurface',\n        'connectgaps',\n        'opacity'\n    ].forEach(function(x) { coerce(x); });\n\n    var surfaceColor = coerce('surfacecolor');\n\n    var dims = ['x', 'y', 'z'];\n    for(i = 0; i < 3; ++i) {\n        var contourDim = 'contours.' + dims[i];\n        var show = coerce(contourDim + '.show');\n        var highlight = coerce(contourDim + '.highlight');\n\n        if(show || highlight) {\n            for(j = 0; j < 3; ++j) {\n                coerce(contourDim + '.project.' + dims[j]);\n            }\n        }\n\n        if(show) {\n            coerce(contourDim + '.color');\n            coerce(contourDim + '.width');\n            coerce(contourDim + '.usecolormap');\n        }\n\n        if(highlight) {\n            coerce(contourDim + '.highlightcolor');\n            coerce(contourDim + '.highlightwidth');\n        }\n\n        coerce(contourDim + '.start');\n        coerce(contourDim + '.end');\n        coerce(contourDim + '.size');\n    }\n\n    // backward compatibility block\n    if(!surfaceColor) {\n        mapLegacy(traceIn, 'zmin', 'cmin');\n        mapLegacy(traceIn, 'zmax', 'cmax');\n        mapLegacy(traceIn, 'zauto', 'cauto');\n    }\n\n    // TODO if contours.?.usecolormap are false and hidesurface is true\n    // the colorbar shouldn't be shown by default\n\n    colorscaleDefaults(\n        traceIn, traceOut, layout, coerce, {prefix: '', cLetter: 'c'}\n    );\n\n    opacityscaleDefaults(traceIn, traceOut, layout, coerce);\n\n    // disable 1D transforms - currently surface does NOT support column data like heatmap does\n    // you can use mesh3d for this use case, but not surface\n    traceOut._length = null;\n}\n\nfunction opacityscaleDefaults(traceIn, traceOut, layout, coerce) {\n    var opacityscale = coerce('opacityscale');\n    if(opacityscale === 'max') {\n        traceOut.opacityscale = [[0, MIN], [1, 1]];\n    } else if(opacityscale === 'min') {\n        traceOut.opacityscale = [[0, 1], [1, MIN]];\n    } else if(opacityscale === 'extremes') {\n        traceOut.opacityscale = createWave(1, MIN);\n    } else if(!isValidScaleArray(opacityscale)) {\n        traceOut.opacityscale = undefined;\n    }\n}\n\nfunction mapLegacy(traceIn, oldAttr, newAttr) {\n    if(oldAttr in traceIn && !(newAttr in traceIn)) {\n        traceIn[newAttr] = traceIn[oldAttr];\n    }\n}\n\nmodule.exports = {\n    supplyDefaults: supplyDefaults,\n    opacityscaleDefaults: opacityscaleDefaults\n};\n"],"mappings":"AAAA,YAAY;;AAEZ,IAAIA,QAAQ,GAAGC,OAAO,CAAC,gBAAgB,CAAC;AACxC,IAAIC,GAAG,GAAGD,OAAO,CAAC,WAAW,CAAC;AAE9B,IAAIE,kBAAkB,GAAGF,OAAO,CAAC,sCAAsC,CAAC;AACxE,IAAIG,UAAU,GAAGH,OAAO,CAAC,cAAc,CAAC;AAExC,IAAII,GAAG,GAAG,GAAG,CAAC,CAAC;;AAEf,SAASC,UAAUA,CAACC,CAAC,EAAEC,UAAU,EAAE;EAC/B,IAAIC,GAAG,GAAG,EAAE;EACZ,IAAIC,KAAK,GAAG,EAAE,CAAC,CAAC;EAChB,KAAI,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGD,KAAK,EAAEC,CAAC,EAAE,EAAE;IAC3B,IAAIC,CAAC,GAAGD,CAAC,IAAID,KAAK,GAAG,CAAC,CAAC;IACvB,IAAIG,CAAC,GAAGL,UAAU,GAAG,CAAC,CAAC,GAAGA,UAAU,KAAK,CAAC,GAAGM,IAAI,CAACC,GAAG,CAACD,IAAI,CAACE,GAAG,CAACT,CAAC,GAAGK,CAAC,GAAGE,IAAI,CAACG,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IACpFR,GAAG,CAACS,IAAI,CAAC,CACLN,CAAC,EACDE,IAAI,CAACK,GAAG,CAAC,CAAC,EAAEL,IAAI,CAACM,GAAG,CAAC,CAAC,EAAEP,CAAC,CAAC,CAAC,CAC9B,CAAC;EACN;EACA,OAAOJ,GAAG;AACd;AAEA,SAASY,iBAAiBA,CAACC,GAAG,EAAE;EAC5B,IAAIC,UAAU,GAAG,CAAC;EAElB,IAAG,CAACC,KAAK,CAACC,OAAO,CAACH,GAAG,CAAC,IAAIA,GAAG,CAACI,MAAM,GAAG,CAAC,EAAE,OAAO,KAAK;EAEtD,IAAG,CAACJ,GAAG,CAAC,CAAC,CAAC,IAAI,CAACA,GAAG,CAACA,GAAG,CAACI,MAAM,GAAG,CAAC,CAAC,EAAE,OAAO,KAAK;EAEhD,IAAG,CAACJ,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,CAACA,GAAG,CAACA,GAAG,CAACI,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,EAAE,OAAO,KAAK;EAElE,KAAI,IAAIf,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGW,GAAG,CAACI,MAAM,EAAEf,CAAC,EAAE,EAAE;IAChC,IAAIgB,EAAE,GAAGL,GAAG,CAACX,CAAC,CAAC;IAEf,IAAGgB,EAAE,CAACD,MAAM,KAAK,CAAC,IAAI,CAACC,EAAE,CAAC,CAAC,CAAC,GAAGJ,UAAU,EAAE;MACvC,OAAO,KAAK;IAChB;IAEAA,UAAU,GAAG,CAACI,EAAE,CAAC,CAAC,CAAC;EACvB;EAEA,OAAO,IAAI;AACf;AAEA,SAASC,cAAcA,CAACC,OAAO,EAAEC,QAAQ,EAAEC,YAAY,EAAEC,MAAM,EAAE;EAC7D,IAAIrB,CAAC,EAAEsB,CAAC;EAER,SAASC,MAAMA,CAACC,IAAI,EAAEC,IAAI,EAAE;IACxB,OAAOlC,GAAG,CAACgC,MAAM,CAACL,OAAO,EAAEC,QAAQ,EAAE1B,UAAU,EAAE+B,IAAI,EAAEC,IAAI,CAAC;EAChE;EAEA,IAAIC,CAAC,GAAGH,MAAM,CAAC,GAAG,CAAC;EACnB,IAAII,CAAC,GAAGJ,MAAM,CAAC,GAAG,CAAC;EAEnB,IAAIK,CAAC,GAAGL,MAAM,CAAC,GAAG,CAAC;EACnB,IAAG,CAACK,CAAC,IAAI,CAACA,CAAC,CAACb,MAAM,KACdW,CAAC,GAAIA,CAAC,CAACX,MAAM,GAAG,CAAC,GAAI,KAAK,CAAC,KAC3BY,CAAC,GAAIA,CAAC,CAACZ,MAAM,GAAG,CAAC,GAAI,KAAK,CAAC,EAC7B;IACEI,QAAQ,CAACU,OAAO,GAAG,KAAK;IACxB;EACJ;EAEAV,QAAQ,CAACW,QAAQ,GAAIjB,KAAK,CAACC,OAAO,CAACY,CAAC,CAAC,IAAInC,GAAG,CAACwC,mBAAmB,CAACL,CAAC,CAAC,CAAC,CAAC,CAAC,GAAIE,CAAC,CAACb,MAAM,GAAGa,CAAC,CAAC,CAAC,CAAC,CAACb,MAAM;EAChGI,QAAQ,CAACa,QAAQ,GAAGJ,CAAC,CAACb,MAAM;EAE5B,IAAIkB,sBAAsB,GAAG5C,QAAQ,CAAC6C,kBAAkB,CAAC,WAAW,EAAE,qBAAqB,CAAC;EAC5FD,sBAAsB,CAACf,OAAO,EAAEC,QAAQ,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,EAAEE,MAAM,CAAC;EAElEE,MAAM,CAAC,MAAM,CAAC;EACdA,MAAM,CAAC,WAAW,CAAC;EACnBA,MAAM,CAAC,eAAe,CAAC;EACvBA,MAAM,CAAC,cAAc,CAAC;EACtBA,MAAM,CAAC,cAAc,CAAC;EACtBA,MAAM,CAAC,cAAc,CAAC;;EAEtB;EACA,CACI,kBAAkB,EAClB,kBAAkB,EAClB,mBAAmB,EACnB,oBAAoB,EACpB,kBAAkB,EAClB,iBAAiB,EACjB,iBAAiB,EACjB,iBAAiB,EACjB,aAAa,EACb,aAAa,EACb,SAAS,CACZ,CAACY,OAAO,CAAC,UAAST,CAAC,EAAE;IAAEH,MAAM,CAACG,CAAC,CAAC;EAAE,CAAC,CAAC;EAErC,IAAIU,YAAY,GAAGb,MAAM,CAAC,cAAc,CAAC;EAEzC,IAAIc,IAAI,GAAG,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;EAC1B,KAAIrC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,CAAC,EAAE,EAAEA,CAAC,EAAE;IACnB,IAAIsC,UAAU,GAAG,WAAW,GAAGD,IAAI,CAACrC,CAAC,CAAC;IACtC,IAAIuC,IAAI,GAAGhB,MAAM,CAACe,UAAU,GAAG,OAAO,CAAC;IACvC,IAAIE,SAAS,GAAGjB,MAAM,CAACe,UAAU,GAAG,YAAY,CAAC;IAEjD,IAAGC,IAAI,IAAIC,SAAS,EAAE;MAClB,KAAIlB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,CAAC,EAAE,EAAEA,CAAC,EAAE;QACnBC,MAAM,CAACe,UAAU,GAAG,WAAW,GAAGD,IAAI,CAACf,CAAC,CAAC,CAAC;MAC9C;IACJ;IAEA,IAAGiB,IAAI,EAAE;MACLhB,MAAM,CAACe,UAAU,GAAG,QAAQ,CAAC;MAC7Bf,MAAM,CAACe,UAAU,GAAG,QAAQ,CAAC;MAC7Bf,MAAM,CAACe,UAAU,GAAG,cAAc,CAAC;IACvC;IAEA,IAAGE,SAAS,EAAE;MACVjB,MAAM,CAACe,UAAU,GAAG,iBAAiB,CAAC;MACtCf,MAAM,CAACe,UAAU,GAAG,iBAAiB,CAAC;IAC1C;IAEAf,MAAM,CAACe,UAAU,GAAG,QAAQ,CAAC;IAC7Bf,MAAM,CAACe,UAAU,GAAG,MAAM,CAAC;IAC3Bf,MAAM,CAACe,UAAU,GAAG,OAAO,CAAC;EAChC;;EAEA;EACA,IAAG,CAACF,YAAY,EAAE;IACdK,SAAS,CAACvB,OAAO,EAAE,MAAM,EAAE,MAAM,CAAC;IAClCuB,SAAS,CAACvB,OAAO,EAAE,MAAM,EAAE,MAAM,CAAC;IAClCuB,SAAS,CAACvB,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC;EACxC;;EAEA;EACA;;EAEA1B,kBAAkB,CACd0B,OAAO,EAAEC,QAAQ,EAAEE,MAAM,EAAEE,MAAM,EAAE;IAACmB,MAAM,EAAE,EAAE;IAAEC,OAAO,EAAE;EAAG,CAChE,CAAC;EAEDC,oBAAoB,CAAC1B,OAAO,EAAEC,QAAQ,EAAEE,MAAM,EAAEE,MAAM,CAAC;;EAEvD;EACA;EACAJ,QAAQ,CAAC0B,OAAO,GAAG,IAAI;AAC3B;AAEA,SAASD,oBAAoBA,CAAC1B,OAAO,EAAEC,QAAQ,EAAEE,MAAM,EAAEE,MAAM,EAAE;EAC7D,IAAIuB,YAAY,GAAGvB,MAAM,CAAC,cAAc,CAAC;EACzC,IAAGuB,YAAY,KAAK,KAAK,EAAE;IACvB3B,QAAQ,CAAC2B,YAAY,GAAG,CAAC,CAAC,CAAC,EAAEpD,GAAG,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;EAC9C,CAAC,MAAM,IAAGoD,YAAY,KAAK,KAAK,EAAE;IAC9B3B,QAAQ,CAAC2B,YAAY,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,EAAEpD,GAAG,CAAC,CAAC;EAC9C,CAAC,MAAM,IAAGoD,YAAY,KAAK,UAAU,EAAE;IACnC3B,QAAQ,CAAC2B,YAAY,GAAGnD,UAAU,CAAC,CAAC,EAAED,GAAG,CAAC;EAC9C,CAAC,MAAM,IAAG,CAACgB,iBAAiB,CAACoC,YAAY,CAAC,EAAE;IACxC3B,QAAQ,CAAC2B,YAAY,GAAGC,SAAS;EACrC;AACJ;AAEA,SAASN,SAASA,CAACvB,OAAO,EAAE8B,OAAO,EAAEC,OAAO,EAAE;EAC1C,IAAGD,OAAO,IAAI9B,OAAO,IAAI,EAAE+B,OAAO,IAAI/B,OAAO,CAAC,EAAE;IAC5CA,OAAO,CAAC+B,OAAO,CAAC,GAAG/B,OAAO,CAAC8B,OAAO,CAAC;EACvC;AACJ;AAEAE,MAAM,CAACC,OAAO,GAAG;EACblC,cAAc,EAAEA,cAAc;EAC9B2B,oBAAoB,EAAEA;AAC1B,CAAC","ignoreList":[]},"metadata":{},"sourceType":"script"}