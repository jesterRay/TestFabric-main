{"ast":null,"code":"'use strict';\n\nvar setGroupPositions = require('../bar/cross_trace_calc').setGroupPositions;\nmodule.exports = function crossTraceCalc(gd, plotinfo) {\n  var fullLayout = gd._fullLayout;\n  var fullData = gd._fullData;\n  var calcdata = gd.calcdata;\n  var xa = plotinfo.xaxis;\n  var ya = plotinfo.yaxis;\n  var waterfalls = [];\n  var waterfallsVert = [];\n  var waterfallsHorz = [];\n  var cd, i;\n  for (i = 0; i < fullData.length; i++) {\n    var fullTrace = fullData[i];\n    if (fullTrace.visible === true && fullTrace.xaxis === xa._id && fullTrace.yaxis === ya._id && fullTrace.type === 'waterfall') {\n      cd = calcdata[i];\n      if (fullTrace.orientation === 'h') {\n        waterfallsHorz.push(cd);\n      } else {\n        waterfallsVert.push(cd);\n      }\n      waterfalls.push(cd);\n    }\n  }\n  var opts = {\n    mode: fullLayout.waterfallmode,\n    norm: fullLayout.waterfallnorm,\n    gap: fullLayout.waterfallgap,\n    groupgap: fullLayout.waterfallgroupgap\n  };\n  setGroupPositions(gd, xa, ya, waterfallsVert, opts);\n  setGroupPositions(gd, ya, xa, waterfallsHorz, opts);\n  for (i = 0; i < waterfalls.length; i++) {\n    cd = waterfalls[i];\n    for (var j = 0; j < cd.length; j++) {\n      var di = cd[j];\n      if (di.isSum === false) {\n        di.s0 += j === 0 ? 0 : cd[j - 1].s;\n      }\n      if (j + 1 < cd.length) {\n        cd[j].nextP0 = cd[j + 1].p0;\n        cd[j].nextS0 = cd[j + 1].s0;\n      }\n    }\n  }\n};","map":{"version":3,"names":["setGroupPositions","require","module","exports","crossTraceCalc","gd","plotinfo","fullLayout","_fullLayout","fullData","_fullData","calcdata","xa","xaxis","ya","yaxis","waterfalls","waterfallsVert","waterfallsHorz","cd","i","length","fullTrace","visible","_id","type","orientation","push","opts","mode","waterfallmode","norm","waterfallnorm","gap","waterfallgap","groupgap","waterfallgroupgap","j","di","isSum","s0","s","nextP0","p0","nextS0"],"sources":["E:/tog_workspace/TestFabric_main/TestFabric-main/node_modules/plotly.js/src/traces/waterfall/cross_trace_calc.js"],"sourcesContent":["'use strict';\n\nvar setGroupPositions = require('../bar/cross_trace_calc').setGroupPositions;\n\nmodule.exports = function crossTraceCalc(gd, plotinfo) {\n    var fullLayout = gd._fullLayout;\n    var fullData = gd._fullData;\n    var calcdata = gd.calcdata;\n    var xa = plotinfo.xaxis;\n    var ya = plotinfo.yaxis;\n    var waterfalls = [];\n    var waterfallsVert = [];\n    var waterfallsHorz = [];\n    var cd, i;\n\n    for(i = 0; i < fullData.length; i++) {\n        var fullTrace = fullData[i];\n\n        if(\n            fullTrace.visible === true &&\n            fullTrace.xaxis === xa._id &&\n            fullTrace.yaxis === ya._id &&\n            fullTrace.type === 'waterfall'\n        ) {\n            cd = calcdata[i];\n\n            if(fullTrace.orientation === 'h') {\n                waterfallsHorz.push(cd);\n            } else {\n                waterfallsVert.push(cd);\n            }\n\n            waterfalls.push(cd);\n        }\n    }\n\n    var opts = {\n        mode: fullLayout.waterfallmode,\n        norm: fullLayout.waterfallnorm,\n        gap: fullLayout.waterfallgap,\n        groupgap: fullLayout.waterfallgroupgap\n    };\n\n    setGroupPositions(gd, xa, ya, waterfallsVert, opts);\n    setGroupPositions(gd, ya, xa, waterfallsHorz, opts);\n\n    for(i = 0; i < waterfalls.length; i++) {\n        cd = waterfalls[i];\n\n        for(var j = 0; j < cd.length; j++) {\n            var di = cd[j];\n\n            if(di.isSum === false) {\n                di.s0 += (j === 0) ? 0 : cd[j - 1].s;\n            }\n\n            if(j + 1 < cd.length) {\n                cd[j].nextP0 = cd[j + 1].p0;\n                cd[j].nextS0 = cd[j + 1].s0;\n            }\n        }\n    }\n};\n"],"mappings":"AAAA,YAAY;;AAEZ,IAAIA,iBAAiB,GAAGC,OAAO,CAAC,yBAAyB,CAAC,CAACD,iBAAiB;AAE5EE,MAAM,CAACC,OAAO,GAAG,SAASC,cAAcA,CAACC,EAAE,EAAEC,QAAQ,EAAE;EACnD,IAAIC,UAAU,GAAGF,EAAE,CAACG,WAAW;EAC/B,IAAIC,QAAQ,GAAGJ,EAAE,CAACK,SAAS;EAC3B,IAAIC,QAAQ,GAAGN,EAAE,CAACM,QAAQ;EAC1B,IAAIC,EAAE,GAAGN,QAAQ,CAACO,KAAK;EACvB,IAAIC,EAAE,GAAGR,QAAQ,CAACS,KAAK;EACvB,IAAIC,UAAU,GAAG,EAAE;EACnB,IAAIC,cAAc,GAAG,EAAE;EACvB,IAAIC,cAAc,GAAG,EAAE;EACvB,IAAIC,EAAE,EAAEC,CAAC;EAET,KAAIA,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGX,QAAQ,CAACY,MAAM,EAAED,CAAC,EAAE,EAAE;IACjC,IAAIE,SAAS,GAAGb,QAAQ,CAACW,CAAC,CAAC;IAE3B,IACIE,SAAS,CAACC,OAAO,KAAK,IAAI,IAC1BD,SAAS,CAACT,KAAK,KAAKD,EAAE,CAACY,GAAG,IAC1BF,SAAS,CAACP,KAAK,KAAKD,EAAE,CAACU,GAAG,IAC1BF,SAAS,CAACG,IAAI,KAAK,WAAW,EAChC;MACEN,EAAE,GAAGR,QAAQ,CAACS,CAAC,CAAC;MAEhB,IAAGE,SAAS,CAACI,WAAW,KAAK,GAAG,EAAE;QAC9BR,cAAc,CAACS,IAAI,CAACR,EAAE,CAAC;MAC3B,CAAC,MAAM;QACHF,cAAc,CAACU,IAAI,CAACR,EAAE,CAAC;MAC3B;MAEAH,UAAU,CAACW,IAAI,CAACR,EAAE,CAAC;IACvB;EACJ;EAEA,IAAIS,IAAI,GAAG;IACPC,IAAI,EAAEtB,UAAU,CAACuB,aAAa;IAC9BC,IAAI,EAAExB,UAAU,CAACyB,aAAa;IAC9BC,GAAG,EAAE1B,UAAU,CAAC2B,YAAY;IAC5BC,QAAQ,EAAE5B,UAAU,CAAC6B;EACzB,CAAC;EAEDpC,iBAAiB,CAACK,EAAE,EAAEO,EAAE,EAAEE,EAAE,EAAEG,cAAc,EAAEW,IAAI,CAAC;EACnD5B,iBAAiB,CAACK,EAAE,EAAES,EAAE,EAAEF,EAAE,EAAEM,cAAc,EAAEU,IAAI,CAAC;EAEnD,KAAIR,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGJ,UAAU,CAACK,MAAM,EAAED,CAAC,EAAE,EAAE;IACnCD,EAAE,GAAGH,UAAU,CAACI,CAAC,CAAC;IAElB,KAAI,IAAIiB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGlB,EAAE,CAACE,MAAM,EAAEgB,CAAC,EAAE,EAAE;MAC/B,IAAIC,EAAE,GAAGnB,EAAE,CAACkB,CAAC,CAAC;MAEd,IAAGC,EAAE,CAACC,KAAK,KAAK,KAAK,EAAE;QACnBD,EAAE,CAACE,EAAE,IAAKH,CAAC,KAAK,CAAC,GAAI,CAAC,GAAGlB,EAAE,CAACkB,CAAC,GAAG,CAAC,CAAC,CAACI,CAAC;MACxC;MAEA,IAAGJ,CAAC,GAAG,CAAC,GAAGlB,EAAE,CAACE,MAAM,EAAE;QAClBF,EAAE,CAACkB,CAAC,CAAC,CAACK,MAAM,GAAGvB,EAAE,CAACkB,CAAC,GAAG,CAAC,CAAC,CAACM,EAAE;QAC3BxB,EAAE,CAACkB,CAAC,CAAC,CAACO,MAAM,GAAGzB,EAAE,CAACkB,CAAC,GAAG,CAAC,CAAC,CAACG,EAAE;MAC/B;IACJ;EACJ;AACJ,CAAC","ignoreList":[]},"metadata":{},"sourceType":"script"}