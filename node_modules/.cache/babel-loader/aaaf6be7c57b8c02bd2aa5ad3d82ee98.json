{"ast":null,"code":"'use strict';\n\nvar createLinePlot = require('../../../stackgl_modules').gl_line3d;\nvar createScatterPlot = require('../../../stackgl_modules').gl_scatter3d;\nvar createErrorBars = require('../../../stackgl_modules').gl_error3d;\nvar createMesh = require('../../../stackgl_modules').gl_mesh3d;\nvar triangulate = require('../../../stackgl_modules').delaunay_triangulate;\nvar Lib = require('../../lib');\nvar str2RgbaArray = require('../../lib/str2rgbarray');\nvar formatColor = require('../../lib/gl_format_color').formatColor;\nvar makeBubbleSizeFn = require('../scatter/make_bubble_size_func');\nvar DASH_PATTERNS = require('../../constants/gl3d_dashes');\nvar MARKER_SYMBOLS = require('../../constants/gl3d_markers');\nvar Axes = require('../../plots/cartesian/axes');\nvar appendArrayPointValue = require('../../components/fx/helpers').appendArrayPointValue;\nvar calculateError = require('./calc_errors');\nfunction LineWithMarkers(scene, uid) {\n  this.scene = scene;\n  this.uid = uid;\n  this.linePlot = null;\n  this.scatterPlot = null;\n  this.errorBars = null;\n  this.textMarkers = null;\n  this.delaunayMesh = null;\n  this.color = null;\n  this.mode = '';\n  this.dataPoints = [];\n  this.axesBounds = [[-Infinity, -Infinity, -Infinity], [Infinity, Infinity, Infinity]];\n  this.textLabels = null;\n  this.data = null;\n}\nvar proto = LineWithMarkers.prototype;\nproto.handlePick = function (selection) {\n  if (selection.object && (selection.object === this.linePlot || selection.object === this.delaunayMesh || selection.object === this.textMarkers || selection.object === this.scatterPlot)) {\n    var ind = selection.index = selection.data.index;\n    if (selection.object.highlight) {\n      selection.object.highlight(null);\n    }\n    if (this.scatterPlot) {\n      selection.object = this.scatterPlot;\n      this.scatterPlot.highlight(selection.data);\n    }\n    selection.textLabel = '';\n    if (this.textLabels) {\n      if (Lib.isArrayOrTypedArray(this.textLabels)) {\n        if (this.textLabels[ind] || this.textLabels[ind] === 0) {\n          selection.textLabel = this.textLabels[ind];\n        }\n      } else {\n        selection.textLabel = this.textLabels;\n      }\n    }\n    selection.traceCoordinate = [this.data.x[ind], this.data.y[ind], this.data.z[ind]];\n    return true;\n  }\n};\nfunction constructDelaunay(points, color, axis) {\n  var u = (axis + 1) % 3;\n  var v = (axis + 2) % 3;\n  var filteredPoints = [];\n  var filteredIds = [];\n  var i;\n  for (i = 0; i < points.length; ++i) {\n    var p = points[i];\n    if (isNaN(p[u]) || !isFinite(p[u]) || isNaN(p[v]) || !isFinite(p[v])) {\n      continue;\n    }\n    filteredPoints.push([p[u], p[v]]);\n    filteredIds.push(i);\n  }\n  var cells = triangulate(filteredPoints);\n  for (i = 0; i < cells.length; ++i) {\n    var c = cells[i];\n    for (var j = 0; j < c.length; ++j) {\n      c[j] = filteredIds[c[j]];\n    }\n  }\n  return {\n    positions: points,\n    cells: cells,\n    meshColor: color\n  };\n}\nfunction calculateErrorParams(errors) {\n  var capSize = [0.0, 0.0, 0.0];\n  var color = [[0, 0, 0], [0, 0, 0], [0, 0, 0]];\n  var lineWidth = [1.0, 1.0, 1.0];\n  for (var i = 0; i < 3; i++) {\n    var e = errors[i];\n    if (e && e.copy_zstyle !== false && errors[2].visible !== false) e = errors[2];\n    if (!e || !e.visible) continue;\n    capSize[i] = e.width / 2; // ballpark rescaling\n    color[i] = str2RgbaArray(e.color);\n    lineWidth[i] = e.thickness;\n  }\n  return {\n    capSize: capSize,\n    color: color,\n    lineWidth: lineWidth\n  };\n}\nfunction parseAlignmentX(a) {\n  if (a === null || a === undefined) return 0;\n  return a.indexOf('left') > -1 ? -1 : a.indexOf('right') > -1 ? 1 : 0;\n}\nfunction parseAlignmentY(a) {\n  if (a === null || a === undefined) return 0;\n  return a.indexOf('top') > -1 ? -1 : a.indexOf('bottom') > -1 ? 1 : 0;\n}\nfunction calculateTextOffset(tp) {\n  // Read out text properties\n\n  var defaultAlignmentX = 0;\n  var defaultAlignmentY = 0;\n  var textOffset = [defaultAlignmentX, defaultAlignmentY];\n  if (Array.isArray(tp)) {\n    for (var i = 0; i < tp.length; i++) {\n      textOffset[i] = [defaultAlignmentX, defaultAlignmentY];\n      if (tp[i]) {\n        textOffset[i][0] = parseAlignmentX(tp[i]);\n        textOffset[i][1] = parseAlignmentY(tp[i]);\n      }\n    }\n  } else {\n    textOffset[0] = parseAlignmentX(tp);\n    textOffset[1] = parseAlignmentY(tp);\n  }\n  return textOffset;\n}\nfunction calculateSize(sizeIn, sizeFn) {\n  // rough parity with Plotly 2D markers\n  return sizeFn(sizeIn * 4);\n}\nfunction calculateSymbol(symbolIn) {\n  return MARKER_SYMBOLS[symbolIn];\n}\nfunction formatParam(paramIn, len, calculate, dflt, extraFn) {\n  var paramOut = null;\n  if (Lib.isArrayOrTypedArray(paramIn)) {\n    paramOut = [];\n    for (var i = 0; i < len; i++) {\n      if (paramIn[i] === undefined) paramOut[i] = dflt;else paramOut[i] = calculate(paramIn[i], extraFn);\n    }\n  } else paramOut = calculate(paramIn, Lib.identity);\n  return paramOut;\n}\nfunction convertPlotlyOptions(scene, data) {\n  var points = [];\n  var sceneLayout = scene.fullSceneLayout;\n  var scaleFactor = scene.dataScale;\n  var xaxis = sceneLayout.xaxis;\n  var yaxis = sceneLayout.yaxis;\n  var zaxis = sceneLayout.zaxis;\n  var marker = data.marker;\n  var line = data.line;\n  var x = data.x || [];\n  var y = data.y || [];\n  var z = data.z || [];\n  var len = x.length;\n  var xcalendar = data.xcalendar;\n  var ycalendar = data.ycalendar;\n  var zcalendar = data.zcalendar;\n  var xc, yc, zc;\n  var params, i;\n  var text;\n\n  // Convert points\n  for (i = 0; i < len; i++) {\n    // sanitize numbers and apply transforms based on axes.type\n    xc = xaxis.d2l(x[i], 0, xcalendar) * scaleFactor[0];\n    yc = yaxis.d2l(y[i], 0, ycalendar) * scaleFactor[1];\n    zc = zaxis.d2l(z[i], 0, zcalendar) * scaleFactor[2];\n    points[i] = [xc, yc, zc];\n  }\n\n  // convert text\n  if (Array.isArray(data.text)) {\n    text = data.text;\n  } else if (Lib.isTypedArray(data.text)) {\n    text = Array.from(data.text);\n  } else if (data.text !== undefined) {\n    text = new Array(len);\n    for (i = 0; i < len; i++) text[i] = data.text;\n  }\n  function formatter(axName, val) {\n    var ax = sceneLayout[axName];\n    return Axes.tickText(ax, ax.d2l(val), true).text;\n  }\n\n  // check texttemplate\n  var texttemplate = data.texttemplate;\n  if (texttemplate) {\n    var fullLayout = scene.fullLayout;\n    var d3locale = fullLayout._d3locale;\n    var isArray = Array.isArray(texttemplate);\n    var N = isArray ? Math.min(texttemplate.length, len) : len;\n    var txt = isArray ? function (i) {\n      return texttemplate[i];\n    } : function () {\n      return texttemplate;\n    };\n    text = new Array(N);\n    for (i = 0; i < N; i++) {\n      var d = {\n        x: x[i],\n        y: y[i],\n        z: z[i]\n      };\n      var labels = {\n        xLabel: formatter('xaxis', x[i]),\n        yLabel: formatter('yaxis', y[i]),\n        zLabel: formatter('zaxis', z[i])\n      };\n      var pointValues = {};\n      appendArrayPointValue(pointValues, data, i);\n      var meta = data._meta || {};\n      text[i] = Lib.texttemplateString(txt(i), labels, d3locale, pointValues, d, meta);\n    }\n  }\n\n  // Build object parameters\n  params = {\n    position: points,\n    mode: data.mode,\n    text: text\n  };\n  if ('line' in data) {\n    params.lineColor = formatColor(line, 1, len);\n    params.lineWidth = line.width;\n    params.lineDashes = line.dash;\n  }\n  if ('marker' in data) {\n    var sizeFn = makeBubbleSizeFn(data);\n    params.scatterColor = formatColor(marker, 1, len);\n    params.scatterSize = formatParam(marker.size, len, calculateSize, 20, sizeFn);\n    params.scatterMarker = formatParam(marker.symbol, len, calculateSymbol, '●');\n    params.scatterLineWidth = marker.line.width; // arrayOk === false\n    params.scatterLineColor = formatColor(marker.line, 1, len);\n    params.scatterAngle = 0;\n  }\n  if ('textposition' in data) {\n    params.textOffset = calculateTextOffset(data.textposition);\n    params.textColor = formatColor(data.textfont, 1, len);\n    params.textSize = formatParam(data.textfont.size, len, Lib.identity, 12);\n    params.textFontFamily = data.textfont.family;\n    params.textFontWeight = data.textfont.weight;\n    params.textFontStyle = data.textfont.style;\n    params.textFontVariant = data.textfont.variant;\n    params.textAngle = 0;\n  }\n  var dims = ['x', 'y', 'z'];\n  params.project = [false, false, false];\n  params.projectScale = [1, 1, 1];\n  params.projectOpacity = [1, 1, 1];\n  for (i = 0; i < 3; ++i) {\n    var projection = data.projection[dims[i]];\n    if (params.project[i] = projection.show) {\n      params.projectOpacity[i] = projection.opacity;\n      params.projectScale[i] = projection.scale;\n    }\n  }\n  params.errorBounds = calculateError(data, scaleFactor, sceneLayout);\n  var errorParams = calculateErrorParams([data.error_x, data.error_y, data.error_z]);\n  params.errorColor = errorParams.color;\n  params.errorLineWidth = errorParams.lineWidth;\n  params.errorCapSize = errorParams.capSize;\n  params.delaunayAxis = data.surfaceaxis;\n  params.delaunayColor = str2RgbaArray(data.surfacecolor);\n  return params;\n}\nfunction _arrayToColor(color) {\n  if (Lib.isArrayOrTypedArray(color)) {\n    var c = color[0];\n    if (Lib.isArrayOrTypedArray(c)) color = c;\n    return 'rgb(' + color.slice(0, 3).map(function (x) {\n      return Math.round(x * 255);\n    }) + ')';\n  }\n  return null;\n}\nfunction arrayToColor(colors) {\n  if (!Lib.isArrayOrTypedArray(colors)) {\n    return null;\n  }\n  if (colors.length === 4 && typeof colors[0] === 'number') {\n    return _arrayToColor(colors);\n  }\n  return colors.map(_arrayToColor);\n}\nproto.update = function (data) {\n  var gl = this.scene.glplot.gl;\n  var lineOptions;\n  var scatterOptions;\n  var errorOptions;\n  var textOptions;\n  var dashPattern = DASH_PATTERNS.solid;\n\n  // Save data\n  this.data = data;\n\n  // Run data conversion\n  var options = convertPlotlyOptions(this.scene, data);\n  if ('mode' in options) {\n    this.mode = options.mode;\n  }\n  if ('lineDashes' in options) {\n    if (options.lineDashes in DASH_PATTERNS) {\n      dashPattern = DASH_PATTERNS[options.lineDashes];\n    }\n  }\n  this.color = arrayToColor(options.scatterColor) || arrayToColor(options.lineColor);\n\n  // Save data points\n  this.dataPoints = options.position;\n  lineOptions = {\n    gl: this.scene.glplot.gl,\n    position: options.position,\n    color: options.lineColor,\n    lineWidth: options.lineWidth || 1,\n    dashes: dashPattern[0],\n    dashScale: dashPattern[1],\n    opacity: data.opacity,\n    connectGaps: data.connectgaps\n  };\n  if (this.mode.indexOf('lines') !== -1) {\n    if (this.linePlot) this.linePlot.update(lineOptions);else {\n      this.linePlot = createLinePlot(lineOptions);\n      this.linePlot._trace = this;\n      this.scene.glplot.add(this.linePlot);\n    }\n  } else if (this.linePlot) {\n    this.scene.glplot.remove(this.linePlot);\n    this.linePlot.dispose();\n    this.linePlot = null;\n  }\n\n  // N.B. marker.opacity must be a scalar for performance\n  var scatterOpacity = data.opacity;\n  if (data.marker && data.marker.opacity !== undefined) scatterOpacity *= data.marker.opacity;\n  scatterOptions = {\n    gl: this.scene.glplot.gl,\n    position: options.position,\n    color: options.scatterColor,\n    size: options.scatterSize,\n    glyph: options.scatterMarker,\n    opacity: scatterOpacity,\n    orthographic: true,\n    lineWidth: options.scatterLineWidth,\n    lineColor: options.scatterLineColor,\n    project: options.project,\n    projectScale: options.projectScale,\n    projectOpacity: options.projectOpacity\n  };\n  if (this.mode.indexOf('markers') !== -1) {\n    if (this.scatterPlot) this.scatterPlot.update(scatterOptions);else {\n      this.scatterPlot = createScatterPlot(scatterOptions);\n      this.scatterPlot._trace = this;\n      this.scatterPlot.highlightScale = 1;\n      this.scene.glplot.add(this.scatterPlot);\n    }\n  } else if (this.scatterPlot) {\n    this.scene.glplot.remove(this.scatterPlot);\n    this.scatterPlot.dispose();\n    this.scatterPlot = null;\n  }\n  textOptions = {\n    gl: this.scene.glplot.gl,\n    position: options.position,\n    glyph: options.text,\n    color: options.textColor,\n    size: options.textSize,\n    angle: options.textAngle,\n    alignment: options.textOffset,\n    font: options.textFontFamily,\n    fontWeight: options.textFontWeight,\n    fontStyle: options.textFontStyle,\n    fontVariant: options.textFontVariant,\n    orthographic: true,\n    lineWidth: 0,\n    project: false,\n    opacity: data.opacity\n  };\n  this.textLabels = data.hovertext || data.text;\n  if (this.mode.indexOf('text') !== -1) {\n    if (this.textMarkers) this.textMarkers.update(textOptions);else {\n      this.textMarkers = createScatterPlot(textOptions);\n      this.textMarkers._trace = this;\n      this.textMarkers.highlightScale = 1;\n      this.scene.glplot.add(this.textMarkers);\n    }\n  } else if (this.textMarkers) {\n    this.scene.glplot.remove(this.textMarkers);\n    this.textMarkers.dispose();\n    this.textMarkers = null;\n  }\n  errorOptions = {\n    gl: this.scene.glplot.gl,\n    position: options.position,\n    color: options.errorColor,\n    error: options.errorBounds,\n    lineWidth: options.errorLineWidth,\n    capSize: options.errorCapSize,\n    opacity: data.opacity\n  };\n  if (this.errorBars) {\n    if (options.errorBounds) {\n      this.errorBars.update(errorOptions);\n    } else {\n      this.scene.glplot.remove(this.errorBars);\n      this.errorBars.dispose();\n      this.errorBars = null;\n    }\n  } else if (options.errorBounds) {\n    this.errorBars = createErrorBars(errorOptions);\n    this.errorBars._trace = this;\n    this.scene.glplot.add(this.errorBars);\n  }\n  if (options.delaunayAxis >= 0) {\n    var delaunayOptions = constructDelaunay(options.position, options.delaunayColor, options.delaunayAxis);\n    delaunayOptions.opacity = data.opacity;\n    if (this.delaunayMesh) {\n      this.delaunayMesh.update(delaunayOptions);\n    } else {\n      delaunayOptions.gl = gl;\n      this.delaunayMesh = createMesh(delaunayOptions);\n      this.delaunayMesh._trace = this;\n      this.scene.glplot.add(this.delaunayMesh);\n    }\n  } else if (this.delaunayMesh) {\n    this.scene.glplot.remove(this.delaunayMesh);\n    this.delaunayMesh.dispose();\n    this.delaunayMesh = null;\n  }\n};\nproto.dispose = function () {\n  if (this.linePlot) {\n    this.scene.glplot.remove(this.linePlot);\n    this.linePlot.dispose();\n  }\n  if (this.scatterPlot) {\n    this.scene.glplot.remove(this.scatterPlot);\n    this.scatterPlot.dispose();\n  }\n  if (this.errorBars) {\n    this.scene.glplot.remove(this.errorBars);\n    this.errorBars.dispose();\n  }\n  if (this.textMarkers) {\n    this.scene.glplot.remove(this.textMarkers);\n    this.textMarkers.dispose();\n  }\n  if (this.delaunayMesh) {\n    this.scene.glplot.remove(this.delaunayMesh);\n    this.delaunayMesh.dispose();\n  }\n};\nfunction createLineWithMarkers(scene, data) {\n  var plot = new LineWithMarkers(scene, data.uid);\n  plot.update(data);\n  return plot;\n}\nmodule.exports = createLineWithMarkers;","map":{"version":3,"names":["createLinePlot","require","gl_line3d","createScatterPlot","gl_scatter3d","createErrorBars","gl_error3d","createMesh","gl_mesh3d","triangulate","delaunay_triangulate","Lib","str2RgbaArray","formatColor","makeBubbleSizeFn","DASH_PATTERNS","MARKER_SYMBOLS","Axes","appendArrayPointValue","calculateError","LineWithMarkers","scene","uid","linePlot","scatterPlot","errorBars","textMarkers","delaunayMesh","color","mode","dataPoints","axesBounds","Infinity","textLabels","data","proto","prototype","handlePick","selection","object","ind","index","highlight","textLabel","isArrayOrTypedArray","traceCoordinate","x","y","z","constructDelaunay","points","axis","u","v","filteredPoints","filteredIds","i","length","p","isNaN","isFinite","push","cells","c","j","positions","meshColor","calculateErrorParams","errors","capSize","lineWidth","e","copy_zstyle","visible","width","thickness","parseAlignmentX","a","undefined","indexOf","parseAlignmentY","calculateTextOffset","tp","defaultAlignmentX","defaultAlignmentY","textOffset","Array","isArray","calculateSize","sizeIn","sizeFn","calculateSymbol","symbolIn","formatParam","paramIn","len","calculate","dflt","extraFn","paramOut","identity","convertPlotlyOptions","sceneLayout","fullSceneLayout","scaleFactor","dataScale","xaxis","yaxis","zaxis","marker","line","xcalendar","ycalendar","zcalendar","xc","yc","zc","params","text","d2l","isTypedArray","from","formatter","axName","val","ax","tickText","texttemplate","fullLayout","d3locale","_d3locale","N","Math","min","txt","d","labels","xLabel","yLabel","zLabel","pointValues","meta","_meta","texttemplateString","position","lineColor","lineDashes","dash","scatterColor","scatterSize","size","scatterMarker","symbol","scatterLineWidth","scatterLineColor","scatterAngle","textposition","textColor","textfont","textSize","textFontFamily","family","textFontWeight","weight","textFontStyle","style","textFontVariant","variant","textAngle","dims","project","projectScale","projectOpacity","projection","show","opacity","scale","errorBounds","errorParams","error_x","error_y","error_z","errorColor","errorLineWidth","errorCapSize","delaunayAxis","surfaceaxis","delaunayColor","surfacecolor","_arrayToColor","slice","map","round","arrayToColor","colors","update","gl","glplot","lineOptions","scatterOptions","errorOptions","textOptions","dashPattern","solid","options","dashes","dashScale","connectGaps","connectgaps","_trace","add","remove","dispose","scatterOpacity","glyph","orthographic","highlightScale","angle","alignment","font","fontWeight","fontStyle","fontVariant","hovertext","error","delaunayOptions","createLineWithMarkers","plot","module","exports"],"sources":["E:/tog_workspace/TestFabric_main/TestFabric-main/node_modules/plotly.js/src/traces/scatter3d/convert.js"],"sourcesContent":["'use strict';\n\nvar createLinePlot = require('../../../stackgl_modules').gl_line3d;\nvar createScatterPlot = require('../../../stackgl_modules').gl_scatter3d;\nvar createErrorBars = require('../../../stackgl_modules').gl_error3d;\nvar createMesh = require('../../../stackgl_modules').gl_mesh3d;\nvar triangulate = require('../../../stackgl_modules').delaunay_triangulate;\n\nvar Lib = require('../../lib');\nvar str2RgbaArray = require('../../lib/str2rgbarray');\nvar formatColor = require('../../lib/gl_format_color').formatColor;\nvar makeBubbleSizeFn = require('../scatter/make_bubble_size_func');\nvar DASH_PATTERNS = require('../../constants/gl3d_dashes');\nvar MARKER_SYMBOLS = require('../../constants/gl3d_markers');\n\nvar Axes = require('../../plots/cartesian/axes');\nvar appendArrayPointValue = require('../../components/fx/helpers').appendArrayPointValue;\n\nvar calculateError = require('./calc_errors');\n\nfunction LineWithMarkers(scene, uid) {\n    this.scene = scene;\n    this.uid = uid;\n    this.linePlot = null;\n    this.scatterPlot = null;\n    this.errorBars = null;\n    this.textMarkers = null;\n    this.delaunayMesh = null;\n    this.color = null;\n    this.mode = '';\n    this.dataPoints = [];\n    this.axesBounds = [\n        [-Infinity, -Infinity, -Infinity],\n        [Infinity, Infinity, Infinity]\n    ];\n    this.textLabels = null;\n    this.data = null;\n}\n\nvar proto = LineWithMarkers.prototype;\n\nproto.handlePick = function(selection) {\n    if(selection.object &&\n        (selection.object === this.linePlot ||\n         selection.object === this.delaunayMesh ||\n         selection.object === this.textMarkers ||\n         selection.object === this.scatterPlot)\n    ) {\n        var ind = selection.index = selection.data.index;\n\n        if(selection.object.highlight) {\n            selection.object.highlight(null);\n        }\n        if(this.scatterPlot) {\n            selection.object = this.scatterPlot;\n            this.scatterPlot.highlight(selection.data);\n        }\n\n        selection.textLabel = '';\n        if(this.textLabels) {\n            if(Lib.isArrayOrTypedArray(this.textLabels)) {\n                if(this.textLabels[ind] || this.textLabels[ind] === 0) {\n                    selection.textLabel = this.textLabels[ind];\n                }\n            } else {\n                selection.textLabel = this.textLabels;\n            }\n        }\n\n        selection.traceCoordinate = [\n            this.data.x[ind],\n            this.data.y[ind],\n            this.data.z[ind]\n        ];\n\n        return true;\n    }\n};\n\nfunction constructDelaunay(points, color, axis) {\n    var u = (axis + 1) % 3;\n    var v = (axis + 2) % 3;\n    var filteredPoints = [];\n    var filteredIds = [];\n    var i;\n\n    for(i = 0; i < points.length; ++i) {\n        var p = points[i];\n        if(isNaN(p[u]) || !isFinite(p[u]) ||\n           isNaN(p[v]) || !isFinite(p[v])) {\n            continue;\n        }\n        filteredPoints.push([p[u], p[v]]);\n        filteredIds.push(i);\n    }\n    var cells = triangulate(filteredPoints);\n    for(i = 0; i < cells.length; ++i) {\n        var c = cells[i];\n        for(var j = 0; j < c.length; ++j) {\n            c[j] = filteredIds[c[j]];\n        }\n    }\n    return {\n        positions: points,\n        cells: cells,\n        meshColor: color\n    };\n}\n\nfunction calculateErrorParams(errors) {\n    var capSize = [0.0, 0.0, 0.0];\n    var color = [[0, 0, 0], [0, 0, 0], [0, 0, 0]];\n    var lineWidth = [1.0, 1.0, 1.0];\n\n    for(var i = 0; i < 3; i++) {\n        var e = errors[i];\n\n        if(e && e.copy_zstyle !== false && errors[2].visible !== false) e = errors[2];\n        if(!e || !e.visible) continue;\n\n        capSize[i] = e.width / 2;  // ballpark rescaling\n        color[i] = str2RgbaArray(e.color);\n        lineWidth[i] = e.thickness;\n    }\n\n    return {capSize: capSize, color: color, lineWidth: lineWidth};\n}\n\nfunction parseAlignmentX(a) {\n    if(a === null || a === undefined) return 0;\n\n    return (a.indexOf('left') > -1) ? -1 :\n           (a.indexOf('right') > -1) ? 1 : 0;\n}\n\nfunction parseAlignmentY(a) {\n    if(a === null || a === undefined) return 0;\n\n    return (a.indexOf('top') > -1) ? -1 :\n           (a.indexOf('bottom') > -1) ? 1 : 0;\n}\n\nfunction calculateTextOffset(tp) {\n    // Read out text properties\n\n    var defaultAlignmentX = 0;\n    var defaultAlignmentY = 0;\n\n    var textOffset = [\n        defaultAlignmentX,\n        defaultAlignmentY\n    ];\n\n    if(Array.isArray(tp)) {\n        for(var i = 0; i < tp.length; i++) {\n            textOffset[i] = [\n                defaultAlignmentX,\n                defaultAlignmentY\n            ];\n            if(tp[i]) {\n                textOffset[i][0] = parseAlignmentX(tp[i]);\n                textOffset[i][1] = parseAlignmentY(tp[i]);\n            }\n        }\n    } else {\n        textOffset[0] = parseAlignmentX(tp);\n        textOffset[1] = parseAlignmentY(tp);\n    }\n\n    return textOffset;\n}\n\n\nfunction calculateSize(sizeIn, sizeFn) {\n    // rough parity with Plotly 2D markers\n    return sizeFn(sizeIn * 4);\n}\n\nfunction calculateSymbol(symbolIn) {\n    return MARKER_SYMBOLS[symbolIn];\n}\n\nfunction formatParam(paramIn, len, calculate, dflt, extraFn) {\n    var paramOut = null;\n\n    if(Lib.isArrayOrTypedArray(paramIn)) {\n        paramOut = [];\n\n        for(var i = 0; i < len; i++) {\n            if(paramIn[i] === undefined) paramOut[i] = dflt;\n            else paramOut[i] = calculate(paramIn[i], extraFn);\n        }\n    } else paramOut = calculate(paramIn, Lib.identity);\n\n    return paramOut;\n}\n\n\nfunction convertPlotlyOptions(scene, data) {\n    var points = [];\n    var sceneLayout = scene.fullSceneLayout;\n    var scaleFactor = scene.dataScale;\n    var xaxis = sceneLayout.xaxis;\n    var yaxis = sceneLayout.yaxis;\n    var zaxis = sceneLayout.zaxis;\n    var marker = data.marker;\n    var line = data.line;\n    var x = data.x || [];\n    var y = data.y || [];\n    var z = data.z || [];\n    var len = x.length;\n    var xcalendar = data.xcalendar;\n    var ycalendar = data.ycalendar;\n    var zcalendar = data.zcalendar;\n    var xc, yc, zc;\n    var params, i;\n    var text;\n\n    // Convert points\n    for(i = 0; i < len; i++) {\n        // sanitize numbers and apply transforms based on axes.type\n        xc = xaxis.d2l(x[i], 0, xcalendar) * scaleFactor[0];\n        yc = yaxis.d2l(y[i], 0, ycalendar) * scaleFactor[1];\n        zc = zaxis.d2l(z[i], 0, zcalendar) * scaleFactor[2];\n\n        points[i] = [xc, yc, zc];\n    }\n\n    // convert text\n    if(Array.isArray(data.text)) {\n        text = data.text;\n    } else if(Lib.isTypedArray(data.text)) {\n        text = Array.from(data.text);\n    } else if(data.text !== undefined) {\n        text = new Array(len);\n        for(i = 0; i < len; i++) text[i] = data.text;\n    }\n\n    function formatter(axName, val) {\n        var ax = sceneLayout[axName];\n        return Axes.tickText(ax, ax.d2l(val), true).text;\n    }\n\n    // check texttemplate\n    var texttemplate = data.texttemplate;\n    if(texttemplate) {\n        var fullLayout = scene.fullLayout;\n        var d3locale = fullLayout._d3locale;\n        var isArray = Array.isArray(texttemplate);\n        var N = isArray ? Math.min(texttemplate.length, len) : len;\n        var txt = isArray ?\n            function(i) { return texttemplate[i]; } :\n            function() { return texttemplate; };\n\n        text = new Array(N);\n\n        for(i = 0; i < N; i++) {\n            var d = {x: x[i], y: y[i], z: z[i]};\n            var labels = {\n                xLabel: formatter('xaxis', x[i]),\n                yLabel: formatter('yaxis', y[i]),\n                zLabel: formatter('zaxis', z[i])\n            };\n            var pointValues = {};\n            appendArrayPointValue(pointValues, data, i);\n            var meta = data._meta || {};\n            text[i] = Lib.texttemplateString(txt(i), labels, d3locale, pointValues, d, meta);\n        }\n    }\n\n    // Build object parameters\n    params = {\n        position: points,\n        mode: data.mode,\n        text: text\n    };\n\n    if('line' in data) {\n        params.lineColor = formatColor(line, 1, len);\n        params.lineWidth = line.width;\n        params.lineDashes = line.dash;\n    }\n\n    if('marker' in data) {\n        var sizeFn = makeBubbleSizeFn(data);\n\n        params.scatterColor = formatColor(marker, 1, len);\n        params.scatterSize = formatParam(marker.size, len, calculateSize, 20, sizeFn);\n        params.scatterMarker = formatParam(marker.symbol, len, calculateSymbol, '●');\n        params.scatterLineWidth = marker.line.width;  // arrayOk === false\n        params.scatterLineColor = formatColor(marker.line, 1, len);\n        params.scatterAngle = 0;\n    }\n\n    if('textposition' in data) {\n        params.textOffset = calculateTextOffset(data.textposition);\n        params.textColor = formatColor(data.textfont, 1, len);\n        params.textSize = formatParam(data.textfont.size, len, Lib.identity, 12);\n        params.textFontFamily = data.textfont.family;\n        params.textFontWeight = data.textfont.weight;\n        params.textFontStyle = data.textfont.style;\n        params.textFontVariant = data.textfont.variant;\n        params.textAngle = 0;\n    }\n\n    var dims = ['x', 'y', 'z'];\n    params.project = [false, false, false];\n    params.projectScale = [1, 1, 1];\n    params.projectOpacity = [1, 1, 1];\n    for(i = 0; i < 3; ++i) {\n        var projection = data.projection[dims[i]];\n        if((params.project[i] = projection.show)) {\n            params.projectOpacity[i] = projection.opacity;\n            params.projectScale[i] = projection.scale;\n        }\n    }\n\n    params.errorBounds = calculateError(data, scaleFactor, sceneLayout);\n\n    var errorParams = calculateErrorParams([data.error_x, data.error_y, data.error_z]);\n    params.errorColor = errorParams.color;\n    params.errorLineWidth = errorParams.lineWidth;\n    params.errorCapSize = errorParams.capSize;\n\n    params.delaunayAxis = data.surfaceaxis;\n    params.delaunayColor = str2RgbaArray(data.surfacecolor);\n\n    return params;\n}\n\nfunction _arrayToColor(color) {\n    if(Lib.isArrayOrTypedArray(color)) {\n        var c = color[0];\n\n        if(Lib.isArrayOrTypedArray(c)) color = c;\n\n        return 'rgb(' + color.slice(0, 3).map(function(x) {\n            return Math.round(x * 255);\n        }) + ')';\n    }\n\n    return null;\n}\n\nfunction arrayToColor(colors) {\n    if(!Lib.isArrayOrTypedArray(colors)) {\n        return null;\n    }\n\n    if((colors.length === 4) && (typeof colors[0] === 'number')) {\n        return _arrayToColor(colors);\n    }\n\n    return colors.map(_arrayToColor);\n}\n\nproto.update = function(data) {\n    var gl = this.scene.glplot.gl;\n    var lineOptions;\n    var scatterOptions;\n    var errorOptions;\n    var textOptions;\n    var dashPattern = DASH_PATTERNS.solid;\n\n    // Save data\n    this.data = data;\n\n    // Run data conversion\n    var options = convertPlotlyOptions(this.scene, data);\n\n    if('mode' in options) {\n        this.mode = options.mode;\n    }\n    if('lineDashes' in options) {\n        if(options.lineDashes in DASH_PATTERNS) {\n            dashPattern = DASH_PATTERNS[options.lineDashes];\n        }\n    }\n\n    this.color = arrayToColor(options.scatterColor) ||\n                 arrayToColor(options.lineColor);\n\n    // Save data points\n    this.dataPoints = options.position;\n\n    lineOptions = {\n        gl: this.scene.glplot.gl,\n        position: options.position,\n        color: options.lineColor,\n        lineWidth: options.lineWidth || 1,\n        dashes: dashPattern[0],\n        dashScale: dashPattern[1],\n        opacity: data.opacity,\n        connectGaps: data.connectgaps\n    };\n\n    if(this.mode.indexOf('lines') !== -1) {\n        if(this.linePlot) this.linePlot.update(lineOptions);\n        else {\n            this.linePlot = createLinePlot(lineOptions);\n            this.linePlot._trace = this;\n            this.scene.glplot.add(this.linePlot);\n        }\n    } else if(this.linePlot) {\n        this.scene.glplot.remove(this.linePlot);\n        this.linePlot.dispose();\n        this.linePlot = null;\n    }\n\n    // N.B. marker.opacity must be a scalar for performance\n    var scatterOpacity = data.opacity;\n    if(data.marker && data.marker.opacity !== undefined) scatterOpacity *= data.marker.opacity;\n\n    scatterOptions = {\n        gl: this.scene.glplot.gl,\n        position: options.position,\n        color: options.scatterColor,\n        size: options.scatterSize,\n        glyph: options.scatterMarker,\n        opacity: scatterOpacity,\n        orthographic: true,\n        lineWidth: options.scatterLineWidth,\n        lineColor: options.scatterLineColor,\n        project: options.project,\n        projectScale: options.projectScale,\n        projectOpacity: options.projectOpacity\n    };\n\n    if(this.mode.indexOf('markers') !== -1) {\n        if(this.scatterPlot) this.scatterPlot.update(scatterOptions);\n        else {\n            this.scatterPlot = createScatterPlot(scatterOptions);\n            this.scatterPlot._trace = this;\n            this.scatterPlot.highlightScale = 1;\n            this.scene.glplot.add(this.scatterPlot);\n        }\n    } else if(this.scatterPlot) {\n        this.scene.glplot.remove(this.scatterPlot);\n        this.scatterPlot.dispose();\n        this.scatterPlot = null;\n    }\n\n    textOptions = {\n        gl: this.scene.glplot.gl,\n        position: options.position,\n        glyph: options.text,\n        color: options.textColor,\n        size: options.textSize,\n        angle: options.textAngle,\n        alignment: options.textOffset,\n        font: options.textFontFamily,\n        fontWeight: options.textFontWeight,\n        fontStyle: options.textFontStyle,\n        fontVariant: options.textFontVariant,\n        orthographic: true,\n        lineWidth: 0,\n        project: false,\n        opacity: data.opacity\n    };\n\n    this.textLabels = data.hovertext || data.text;\n\n    if(this.mode.indexOf('text') !== -1) {\n        if(this.textMarkers) this.textMarkers.update(textOptions);\n        else {\n            this.textMarkers = createScatterPlot(textOptions);\n            this.textMarkers._trace = this;\n            this.textMarkers.highlightScale = 1;\n            this.scene.glplot.add(this.textMarkers);\n        }\n    } else if(this.textMarkers) {\n        this.scene.glplot.remove(this.textMarkers);\n        this.textMarkers.dispose();\n        this.textMarkers = null;\n    }\n\n    errorOptions = {\n        gl: this.scene.glplot.gl,\n        position: options.position,\n        color: options.errorColor,\n        error: options.errorBounds,\n        lineWidth: options.errorLineWidth,\n        capSize: options.errorCapSize,\n        opacity: data.opacity\n    };\n    if(this.errorBars) {\n        if(options.errorBounds) {\n            this.errorBars.update(errorOptions);\n        } else {\n            this.scene.glplot.remove(this.errorBars);\n            this.errorBars.dispose();\n            this.errorBars = null;\n        }\n    } else if(options.errorBounds) {\n        this.errorBars = createErrorBars(errorOptions);\n        this.errorBars._trace = this;\n        this.scene.glplot.add(this.errorBars);\n    }\n\n    if(options.delaunayAxis >= 0) {\n        var delaunayOptions = constructDelaunay(\n            options.position,\n            options.delaunayColor,\n            options.delaunayAxis\n        );\n        delaunayOptions.opacity = data.opacity;\n\n        if(this.delaunayMesh) {\n            this.delaunayMesh.update(delaunayOptions);\n        } else {\n            delaunayOptions.gl = gl;\n            this.delaunayMesh = createMesh(delaunayOptions);\n            this.delaunayMesh._trace = this;\n            this.scene.glplot.add(this.delaunayMesh);\n        }\n    } else if(this.delaunayMesh) {\n        this.scene.glplot.remove(this.delaunayMesh);\n        this.delaunayMesh.dispose();\n        this.delaunayMesh = null;\n    }\n};\n\nproto.dispose = function() {\n    if(this.linePlot) {\n        this.scene.glplot.remove(this.linePlot);\n        this.linePlot.dispose();\n    }\n    if(this.scatterPlot) {\n        this.scene.glplot.remove(this.scatterPlot);\n        this.scatterPlot.dispose();\n    }\n    if(this.errorBars) {\n        this.scene.glplot.remove(this.errorBars);\n        this.errorBars.dispose();\n    }\n    if(this.textMarkers) {\n        this.scene.glplot.remove(this.textMarkers);\n        this.textMarkers.dispose();\n    }\n    if(this.delaunayMesh) {\n        this.scene.glplot.remove(this.delaunayMesh);\n        this.delaunayMesh.dispose();\n    }\n};\n\nfunction createLineWithMarkers(scene, data) {\n    var plot = new LineWithMarkers(scene, data.uid);\n    plot.update(data);\n    return plot;\n}\n\nmodule.exports = createLineWithMarkers;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script"}