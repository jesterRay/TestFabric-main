{"ast":null,"code":"'use strict';\n\nvar Lib = require('../../lib');\nvar pushUnique = Lib.pushUnique;\nvar subTypes = require('../scatter/subtypes');\nvar helpers = require('./helpers');\nmodule.exports = function select(searchInfo, selectionTester) {\n  var cd = searchInfo.cd;\n  var trace = cd[0].trace;\n  var stash = cd[0].t;\n  var scene = searchInfo.scene;\n  var cdata = scene.matrixOptions.cdata;\n  var xa = searchInfo.xaxis;\n  var ya = searchInfo.yaxis;\n  var selection = [];\n  if (!scene) return selection;\n  var hasOnlyLines = !subTypes.hasMarkers(trace) && !subTypes.hasText(trace);\n  if (trace.visible !== true || hasOnlyLines) return selection;\n  var xi = helpers.getDimIndex(trace, xa);\n  var yi = helpers.getDimIndex(trace, ya);\n  if (xi === false || yi === false) return selection;\n  var xpx = stash.xpx[xi];\n  var ypx = stash.ypx[yi];\n  var x = cdata[xi];\n  var y = cdata[yi];\n  var els = (searchInfo.scene.selectBatch || []).slice();\n  var unels = [];\n\n  // degenerate polygon does not enable selection\n  // filter out points by visible scatter ones\n  if (selectionTester !== false && !selectionTester.degenerate) {\n    for (var i = 0; i < x.length; i++) {\n      if (selectionTester.contains([xpx[i], ypx[i]], null, i, searchInfo)) {\n        selection.push({\n          pointNumber: i,\n          x: x[i],\n          y: y[i]\n        });\n        pushUnique(els, i);\n      } else if (els.indexOf(i) !== -1) {\n        pushUnique(els, i);\n      } else {\n        unels.push(i);\n      }\n    }\n  }\n  var matrixOpts = scene.matrixOptions;\n  if (!els.length && !unels.length) {\n    scene.matrix.update(matrixOpts, null);\n  } else if (!scene.selectBatch.length && !scene.unselectBatch.length) {\n    scene.matrix.update(scene.unselectedOptions, Lib.extendFlat({}, matrixOpts, scene.selectedOptions, scene.viewOpts));\n  }\n  scene.selectBatch = els;\n  scene.unselectBatch = unels;\n  return selection;\n};","map":{"version":3,"names":["Lib","require","pushUnique","subTypes","helpers","module","exports","select","searchInfo","selectionTester","cd","trace","stash","t","scene","cdata","matrixOptions","xa","xaxis","ya","yaxis","selection","hasOnlyLines","hasMarkers","hasText","visible","xi","getDimIndex","yi","xpx","ypx","x","y","els","selectBatch","slice","unels","degenerate","i","length","contains","push","pointNumber","indexOf","matrixOpts","matrix","update","unselectBatch","unselectedOptions","extendFlat","selectedOptions","viewOpts"],"sources":["E:/tog_workspace/TestFabric_main/TestFabric-main/node_modules/plotly.js/src/traces/splom/select.js"],"sourcesContent":["'use strict';\n\nvar Lib = require('../../lib');\nvar pushUnique = Lib.pushUnique;\nvar subTypes = require('../scatter/subtypes');\nvar helpers = require('./helpers');\n\nmodule.exports = function select(searchInfo, selectionTester) {\n    var cd = searchInfo.cd;\n    var trace = cd[0].trace;\n    var stash = cd[0].t;\n    var scene = searchInfo.scene;\n    var cdata = scene.matrixOptions.cdata;\n    var xa = searchInfo.xaxis;\n    var ya = searchInfo.yaxis;\n    var selection = [];\n\n    if(!scene) return selection;\n\n    var hasOnlyLines = (!subTypes.hasMarkers(trace) && !subTypes.hasText(trace));\n    if(trace.visible !== true || hasOnlyLines) return selection;\n\n    var xi = helpers.getDimIndex(trace, xa);\n    var yi = helpers.getDimIndex(trace, ya);\n    if(xi === false || yi === false) return selection;\n\n    var xpx = stash.xpx[xi];\n    var ypx = stash.ypx[yi];\n    var x = cdata[xi];\n    var y = cdata[yi];\n    var els = (searchInfo.scene.selectBatch || []).slice();\n    var unels = [];\n\n    // degenerate polygon does not enable selection\n    // filter out points by visible scatter ones\n    if(selectionTester !== false && !selectionTester.degenerate) {\n        for(var i = 0; i < x.length; i++) {\n            if(selectionTester.contains([xpx[i], ypx[i]], null, i, searchInfo)) {\n                selection.push({\n                    pointNumber: i,\n                    x: x[i],\n                    y: y[i]\n                });\n\n                pushUnique(els, i);\n            } else if(els.indexOf(i) !== -1) {\n                pushUnique(els, i);\n            } else {\n                unels.push(i);\n            }\n        }\n    }\n\n    var matrixOpts = scene.matrixOptions;\n\n    if(!els.length && !unels.length) {\n        scene.matrix.update(matrixOpts, null);\n    } else if(!scene.selectBatch.length && !scene.unselectBatch.length) {\n        scene.matrix.update(\n            scene.unselectedOptions,\n            Lib.extendFlat({}, matrixOpts, scene.selectedOptions, scene.viewOpts)\n        );\n    }\n\n    scene.selectBatch = els;\n    scene.unselectBatch = unels;\n\n    return selection;\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script"}