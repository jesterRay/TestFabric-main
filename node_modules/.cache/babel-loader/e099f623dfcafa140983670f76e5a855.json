{"ast":null,"code":"'use strict';\n\nvar Fx = require('../../components/fx');\nvar Lib = require('../../lib');\nvar isArrayOrTypedArray = Lib.isArrayOrTypedArray;\nvar constants = require('./constants');\nmodule.exports = function hoverPoints(pointData, xval, yval) {\n  var cd0 = pointData.cd[0];\n  var trace = cd0.trace;\n  var xa = pointData.xa;\n  var ya = pointData.ya;\n\n  // Return early if not on image\n  if (Fx.inbox(xval - cd0.x0, xval - (cd0.x0 + cd0.w * trace.dx), 0) > 0 || Fx.inbox(yval - cd0.y0, yval - (cd0.y0 + cd0.h * trace.dy), 0) > 0) {\n    return;\n  }\n\n  // Find nearest pixel's index\n  var nx = Math.floor((xval - cd0.x0) / trace.dx);\n  var ny = Math.floor(Math.abs(yval - cd0.y0) / trace.dy);\n  var pixel;\n  if (trace._hasZ) {\n    pixel = cd0.z[ny][nx];\n  } else if (trace._hasSource) {\n    pixel = trace._canvas.el.getContext('2d', {\n      willReadFrequently: true\n    }).getImageData(nx, ny, 1, 1).data;\n  }\n\n  // return early if pixel is undefined\n  if (!pixel) return;\n  var hoverinfo = cd0.hi || trace.hoverinfo;\n  var fmtColor;\n  if (hoverinfo) {\n    var parts = hoverinfo.split('+');\n    if (parts.indexOf('all') !== -1) parts = ['color'];\n    if (parts.indexOf('color') !== -1) fmtColor = true;\n  }\n  var cr = constants.colormodel[trace.colormodel];\n  var colormodel = cr.colormodel || trace.colormodel;\n  var dims = colormodel.length;\n  var c = trace._scaler(pixel);\n  var s = cr.suffix;\n  var colorstring = [];\n  if (trace.hovertemplate || fmtColor) {\n    colorstring.push('[' + [c[0] + s[0], c[1] + s[1], c[2] + s[2]].join(', '));\n    if (dims === 4) colorstring.push(', ' + c[3] + s[3]);\n    colorstring.push(']');\n    colorstring = colorstring.join('');\n    pointData.extraText = colormodel.toUpperCase() + ': ' + colorstring;\n  }\n  var text;\n  if (isArrayOrTypedArray(trace.hovertext) && isArrayOrTypedArray(trace.hovertext[ny])) {\n    text = trace.hovertext[ny][nx];\n  } else if (isArrayOrTypedArray(trace.text) && isArrayOrTypedArray(trace.text[ny])) {\n    text = trace.text[ny][nx];\n  }\n\n  // TODO: for color model with 3 dims, display something useful for hovertemplate `%{color[3]}`\n  var py = ya.c2p(cd0.y0 + (ny + 0.5) * trace.dy);\n  var xVal = cd0.x0 + (nx + 0.5) * trace.dx;\n  var yVal = cd0.y0 + (ny + 0.5) * trace.dy;\n  var zLabel = '[' + pixel.slice(0, trace.colormodel.length).join(', ') + ']';\n  return [Lib.extendFlat(pointData, {\n    index: [ny, nx],\n    x0: xa.c2p(cd0.x0 + nx * trace.dx),\n    x1: xa.c2p(cd0.x0 + (nx + 1) * trace.dx),\n    y0: py,\n    y1: py,\n    color: c,\n    xVal: xVal,\n    xLabelVal: xVal,\n    yVal: yVal,\n    yLabelVal: yVal,\n    zLabelVal: zLabel,\n    text: text,\n    hovertemplateLabels: {\n      zLabel: zLabel,\n      colorLabel: colorstring,\n      'color[0]Label': c[0] + s[0],\n      'color[1]Label': c[1] + s[1],\n      'color[2]Label': c[2] + s[2],\n      'color[3]Label': c[3] + s[3]\n    }\n  })];\n};","map":{"version":3,"names":["Fx","require","Lib","isArrayOrTypedArray","constants","module","exports","hoverPoints","pointData","xval","yval","cd0","cd","trace","xa","ya","inbox","x0","w","dx","y0","h","dy","nx","Math","floor","ny","abs","pixel","_hasZ","z","_hasSource","_canvas","el","getContext","willReadFrequently","getImageData","data","hoverinfo","hi","fmtColor","parts","split","indexOf","cr","colormodel","dims","length","c","_scaler","s","suffix","colorstring","hovertemplate","push","join","extraText","toUpperCase","text","hovertext","py","c2p","xVal","yVal","zLabel","slice","extendFlat","index","x1","y1","color","xLabelVal","yLabelVal","zLabelVal","hovertemplateLabels","colorLabel"],"sources":["E:/tog_workspace/TestFabric_main/TestFabric-main/node_modules/plotly.js/src/traces/image/hover.js"],"sourcesContent":["'use strict';\n\nvar Fx = require('../../components/fx');\nvar Lib = require('../../lib');\nvar isArrayOrTypedArray = Lib.isArrayOrTypedArray;\nvar constants = require('./constants');\n\nmodule.exports = function hoverPoints(pointData, xval, yval) {\n    var cd0 = pointData.cd[0];\n    var trace = cd0.trace;\n    var xa = pointData.xa;\n    var ya = pointData.ya;\n\n    // Return early if not on image\n    if(Fx.inbox(xval - cd0.x0, xval - (cd0.x0 + cd0.w * trace.dx), 0) > 0 ||\n            Fx.inbox(yval - cd0.y0, yval - (cd0.y0 + cd0.h * trace.dy), 0) > 0) {\n        return;\n    }\n\n    // Find nearest pixel's index\n    var nx = Math.floor((xval - cd0.x0) / trace.dx);\n    var ny = Math.floor(Math.abs(yval - cd0.y0) / trace.dy);\n\n    var pixel;\n    if(trace._hasZ) {\n        pixel = cd0.z[ny][nx];\n    } else if(trace._hasSource) {\n        pixel = trace._canvas.el.getContext('2d', {willReadFrequently: true}).getImageData(nx, ny, 1, 1).data;\n    }\n\n    // return early if pixel is undefined\n    if(!pixel) return;\n\n    var hoverinfo = cd0.hi || trace.hoverinfo;\n    var fmtColor;\n    if(hoverinfo) {\n        var parts = hoverinfo.split('+');\n        if(parts.indexOf('all') !== -1) parts = ['color'];\n        if(parts.indexOf('color') !== -1) fmtColor = true;\n    }\n\n    var cr = constants.colormodel[trace.colormodel];\n    var colormodel = cr.colormodel || trace.colormodel;\n    var dims = colormodel.length;\n    var c = trace._scaler(pixel);\n    var s = cr.suffix;\n\n    var colorstring = [];\n    if(trace.hovertemplate || fmtColor) {\n        colorstring.push('[' + [c[0] + s[0], c[1] + s[1], c[2] + s[2]].join(', '));\n        if(dims === 4) colorstring.push(', ' + c[3] + s[3]);\n        colorstring.push(']');\n        colorstring = colorstring.join('');\n        pointData.extraText = colormodel.toUpperCase() + ': ' + colorstring;\n    }\n\n    var text;\n    if(isArrayOrTypedArray(trace.hovertext) && isArrayOrTypedArray(trace.hovertext[ny])) {\n        text = trace.hovertext[ny][nx];\n    } else if(isArrayOrTypedArray(trace.text) && isArrayOrTypedArray(trace.text[ny])) {\n        text = trace.text[ny][nx];\n    }\n\n    // TODO: for color model with 3 dims, display something useful for hovertemplate `%{color[3]}`\n    var py = ya.c2p(cd0.y0 + (ny + 0.5) * trace.dy);\n    var xVal = cd0.x0 + (nx + 0.5) * trace.dx;\n    var yVal = cd0.y0 + (ny + 0.5) * trace.dy;\n    var zLabel = '[' + pixel.slice(0, trace.colormodel.length).join(', ') + ']';\n    return [Lib.extendFlat(pointData, {\n        index: [ny, nx],\n        x0: xa.c2p(cd0.x0 + nx * trace.dx),\n        x1: xa.c2p(cd0.x0 + (nx + 1) * trace.dx),\n        y0: py,\n        y1: py,\n        color: c,\n        xVal: xVal,\n        xLabelVal: xVal,\n        yVal: yVal,\n        yLabelVal: yVal,\n        zLabelVal: zLabel,\n        text: text,\n        hovertemplateLabels: {\n            zLabel: zLabel,\n            colorLabel: colorstring,\n            'color[0]Label': c[0] + s[0],\n            'color[1]Label': c[1] + s[1],\n            'color[2]Label': c[2] + s[2],\n            'color[3]Label': c[3] + s[3]\n        }\n    })];\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script"}