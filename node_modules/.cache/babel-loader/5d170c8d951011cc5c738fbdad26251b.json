{"ast":null,"code":"'use strict';\n\nvar d3 = require('@plotly/d3');\nvar interpolate = require('d3-interpolate').interpolate;\nvar interpolateNumber = require('d3-interpolate').interpolateNumber;\nvar Lib = require('../../lib');\nvar strScale = Lib.strScale;\nvar strTranslate = Lib.strTranslate;\nvar rad2deg = Lib.rad2deg;\nvar MID_SHIFT = require('../../constants/alignment').MID_SHIFT;\nvar Drawing = require('../../components/drawing');\nvar cn = require('./constants');\nvar svgTextUtils = require('../../lib/svg_text_utils');\nvar Axes = require('../../plots/cartesian/axes');\nvar handleAxisDefaults = require('../../plots/cartesian/axis_defaults');\nvar handleAxisPositionDefaults = require('../../plots/cartesian/position_defaults');\nvar axisLayoutAttrs = require('../../plots/cartesian/layout_attributes');\nvar Color = require('../../components/color');\nvar anchor = {\n  left: 'start',\n  center: 'middle',\n  right: 'end'\n};\nvar position = {\n  left: 0,\n  center: 0.5,\n  right: 1\n};\nvar SI_PREFIX = /[yzafpnµmkMGTPEZY]/;\nfunction hasTransition(transitionOpts) {\n  // If transition config is provided, then it is only a partial replot and traces not\n  // updated are removed.\n  return transitionOpts && transitionOpts.duration > 0;\n}\nmodule.exports = function plot(gd, cdModule, transitionOpts, makeOnCompleteCallback) {\n  var fullLayout = gd._fullLayout;\n  var onComplete;\n  if (hasTransition(transitionOpts)) {\n    if (makeOnCompleteCallback) {\n      // If it was passed a callback to register completion, make a callback. If\n      // this is created, then it must be executed on completion, otherwise the\n      // pos-transition redraw will not execute:\n      onComplete = makeOnCompleteCallback();\n    }\n  }\n  Lib.makeTraceGroups(fullLayout._indicatorlayer, cdModule, 'trace').each(function (cd) {\n    var cd0 = cd[0];\n    var trace = cd0.trace;\n    var plotGroup = d3.select(this);\n\n    // Elements in trace\n    var hasGauge = trace._hasGauge;\n    var isAngular = trace._isAngular;\n    var isBullet = trace._isBullet;\n\n    // Domain size\n    var domain = trace.domain;\n    var size = {\n      w: fullLayout._size.w * (domain.x[1] - domain.x[0]),\n      h: fullLayout._size.h * (domain.y[1] - domain.y[0]),\n      l: fullLayout._size.l + fullLayout._size.w * domain.x[0],\n      r: fullLayout._size.r + fullLayout._size.w * (1 - domain.x[1]),\n      t: fullLayout._size.t + fullLayout._size.h * (1 - domain.y[1]),\n      b: fullLayout._size.b + fullLayout._size.h * domain.y[0]\n    };\n    var centerX = size.l + size.w / 2;\n    var centerY = size.t + size.h / 2;\n\n    // Angular gauge size\n    var radius = Math.min(size.w / 2, size.h); // fill domain\n    var innerRadius = cn.innerRadius * radius;\n\n    // Position numbers based on mode and set the scaling logic\n    var numbersX, numbersY, numbersScaler;\n    var numbersAlign = trace.align || 'center';\n    numbersY = centerY;\n    if (!hasGauge) {\n      numbersX = size.l + position[numbersAlign] * size.w;\n      numbersScaler = function (el) {\n        return fitTextInsideBox(el, size.w, size.h);\n      };\n    } else {\n      if (isAngular) {\n        numbersX = centerX;\n        numbersY = centerY + radius / 2;\n        numbersScaler = function (el) {\n          return fitTextInsideCircle(el, 0.9 * innerRadius);\n        };\n      }\n      if (isBullet) {\n        var padding = cn.bulletPadding;\n        var p = 1 - cn.bulletNumberDomainSize + padding;\n        numbersX = size.l + (p + (1 - p) * position[numbersAlign]) * size.w;\n        numbersScaler = function (el) {\n          return fitTextInsideBox(el, (cn.bulletNumberDomainSize - padding) * size.w, size.h);\n        };\n      }\n    }\n\n    // Draw numbers\n    drawNumbers(gd, plotGroup, cd, {\n      numbersX: numbersX,\n      numbersY: numbersY,\n      numbersScaler: numbersScaler,\n      transitionOpts: transitionOpts,\n      onComplete: onComplete\n    });\n\n    // Reexpress our gauge background attributes for drawing\n    var gaugeBg, gaugeOutline;\n    if (hasGauge) {\n      gaugeBg = {\n        range: trace.gauge.axis.range,\n        color: trace.gauge.bgcolor,\n        line: {\n          color: trace.gauge.bordercolor,\n          width: 0\n        },\n        thickness: 1\n      };\n      gaugeOutline = {\n        range: trace.gauge.axis.range,\n        color: 'rgba(0, 0, 0, 0)',\n        line: {\n          color: trace.gauge.bordercolor,\n          width: trace.gauge.borderwidth\n        },\n        thickness: 1\n      };\n    }\n\n    // Prepare angular gauge layers\n    var angularGauge = plotGroup.selectAll('g.angular').data(isAngular ? cd : []);\n    angularGauge.exit().remove();\n    var angularaxisLayer = plotGroup.selectAll('g.angularaxis').data(isAngular ? cd : []);\n    angularaxisLayer.exit().remove();\n    if (isAngular) {\n      drawAngularGauge(gd, plotGroup, cd, {\n        radius: radius,\n        innerRadius: innerRadius,\n        gauge: angularGauge,\n        layer: angularaxisLayer,\n        size: size,\n        gaugeBg: gaugeBg,\n        gaugeOutline: gaugeOutline,\n        transitionOpts: transitionOpts,\n        onComplete: onComplete\n      });\n    }\n\n    // Prepare bullet layers\n    var bulletGauge = plotGroup.selectAll('g.bullet').data(isBullet ? cd : []);\n    bulletGauge.exit().remove();\n    var bulletaxisLayer = plotGroup.selectAll('g.bulletaxis').data(isBullet ? cd : []);\n    bulletaxisLayer.exit().remove();\n    if (isBullet) {\n      drawBulletGauge(gd, plotGroup, cd, {\n        gauge: bulletGauge,\n        layer: bulletaxisLayer,\n        size: size,\n        gaugeBg: gaugeBg,\n        gaugeOutline: gaugeOutline,\n        transitionOpts: transitionOpts,\n        onComplete: onComplete\n      });\n    }\n\n    // title\n    var title = plotGroup.selectAll('text.title').data(cd);\n    title.exit().remove();\n    title.enter().append('text').classed('title', true);\n    title.attr('text-anchor', function () {\n      return isBullet ? anchor.right : anchor[trace.title.align];\n    }).text(trace.title.text).call(Drawing.font, trace.title.font).call(svgTextUtils.convertToTspans, gd);\n\n    // Position title\n    title.attr('transform', function () {\n      var titleX = size.l + size.w * position[trace.title.align];\n      var titleY;\n      var titlePadding = cn.titlePadding;\n      var titlebBox = Drawing.bBox(title.node());\n      if (hasGauge) {\n        if (isAngular) {\n          // position above axis ticks/labels\n          if (trace.gauge.axis.visible) {\n            var bBox = Drawing.bBox(angularaxisLayer.node());\n            titleY = bBox.top - titlePadding - titlebBox.bottom;\n          } else {\n            titleY = size.t + size.h / 2 - radius / 2 - titlebBox.bottom - titlePadding;\n          }\n        }\n        if (isBullet) {\n          // position outside domain\n          titleY = numbersY - (titlebBox.top + titlebBox.bottom) / 2;\n          titleX = size.l - cn.bulletPadding * size.w; // Outside domain, on the left\n        }\n      } else {\n        // position above numbers\n        titleY = trace._numbersTop - titlePadding - titlebBox.bottom;\n      }\n      return strTranslate(titleX, titleY);\n    });\n  });\n};\nfunction drawBulletGauge(gd, plotGroup, cd, opts) {\n  var trace = cd[0].trace;\n  var bullet = opts.gauge;\n  var axisLayer = opts.layer;\n  var gaugeBg = opts.gaugeBg;\n  var gaugeOutline = opts.gaugeOutline;\n  var size = opts.size;\n  var domain = trace.domain;\n  var transitionOpts = opts.transitionOpts;\n  var onComplete = opts.onComplete;\n\n  // preparing axis\n  var ax, vals, transFn, tickSign, shift;\n\n  // Enter bullet, axis\n  bullet.enter().append('g').classed('bullet', true);\n  bullet.attr('transform', strTranslate(size.l, size.t));\n  axisLayer.enter().append('g').classed('bulletaxis', true).classed('crisp', true);\n  axisLayer.selectAll('g.' + 'xbulletaxis' + 'tick,path,text').remove();\n\n  // Draw bullet\n  var bulletHeight = size.h; // use all vertical domain\n  var innerBulletHeight = trace.gauge.bar.thickness * bulletHeight;\n  var bulletLeft = domain.x[0];\n  var bulletRight = domain.x[0] + (domain.x[1] - domain.x[0]) * (trace._hasNumber || trace._hasDelta ? 1 - cn.bulletNumberDomainSize : 1);\n  ax = mockAxis(gd, trace.gauge.axis);\n  ax._id = 'xbulletaxis';\n  ax.domain = [bulletLeft, bulletRight];\n  ax.setScale();\n  vals = Axes.calcTicks(ax);\n  transFn = Axes.makeTransTickFn(ax);\n  tickSign = Axes.getTickSigns(ax)[2];\n  shift = size.t + size.h;\n  if (ax.visible) {\n    Axes.drawTicks(gd, ax, {\n      vals: ax.ticks === 'inside' ? Axes.clipEnds(ax, vals) : vals,\n      layer: axisLayer,\n      path: Axes.makeTickPath(ax, shift, tickSign),\n      transFn: transFn\n    });\n    Axes.drawLabels(gd, ax, {\n      vals: vals,\n      layer: axisLayer,\n      transFn: transFn,\n      labelFns: Axes.makeLabelFns(ax, shift)\n    });\n  }\n  function drawRect(s) {\n    s.attr('width', function (d) {\n      return Math.max(0, ax.c2p(d.range[1]) - ax.c2p(d.range[0]));\n    }).attr('x', function (d) {\n      return ax.c2p(d.range[0]);\n    }).attr('y', function (d) {\n      return 0.5 * (1 - d.thickness) * bulletHeight;\n    }).attr('height', function (d) {\n      return d.thickness * bulletHeight;\n    });\n  }\n\n  // Draw bullet background, steps\n  var boxes = [gaugeBg].concat(trace.gauge.steps);\n  var bgBullet = bullet.selectAll('g.bg-bullet').data(boxes);\n  bgBullet.enter().append('g').classed('bg-bullet', true).append('rect');\n  bgBullet.select('rect').call(drawRect).call(styleShape);\n  bgBullet.exit().remove();\n\n  // Draw value bar with transitions\n  var fgBullet = bullet.selectAll('g.value-bullet').data([trace.gauge.bar]);\n  fgBullet.enter().append('g').classed('value-bullet', true).append('rect');\n  fgBullet.select('rect').attr('height', innerBulletHeight).attr('y', (bulletHeight - innerBulletHeight) / 2).call(styleShape);\n  if (hasTransition(transitionOpts)) {\n    fgBullet.select('rect').transition().duration(transitionOpts.duration).ease(transitionOpts.easing).each('end', function () {\n      onComplete && onComplete();\n    }).each('interrupt', function () {\n      onComplete && onComplete();\n    }).attr('width', Math.max(0, ax.c2p(Math.min(trace.gauge.axis.range[1], cd[0].y))));\n  } else {\n    fgBullet.select('rect').attr('width', typeof cd[0].y === 'number' ? Math.max(0, ax.c2p(Math.min(trace.gauge.axis.range[1], cd[0].y))) : 0);\n  }\n  fgBullet.exit().remove();\n  var data = cd.filter(function () {\n    return trace.gauge.threshold.value || trace.gauge.threshold.value === 0;\n  });\n  var threshold = bullet.selectAll('g.threshold-bullet').data(data);\n  threshold.enter().append('g').classed('threshold-bullet', true).append('line');\n  threshold.select('line').attr('x1', ax.c2p(trace.gauge.threshold.value)).attr('x2', ax.c2p(trace.gauge.threshold.value)).attr('y1', (1 - trace.gauge.threshold.thickness) / 2 * bulletHeight).attr('y2', (1 - (1 - trace.gauge.threshold.thickness) / 2) * bulletHeight).call(Color.stroke, trace.gauge.threshold.line.color).style('stroke-width', trace.gauge.threshold.line.width);\n  threshold.exit().remove();\n  var bulletOutline = bullet.selectAll('g.gauge-outline').data([gaugeOutline]);\n  bulletOutline.enter().append('g').classed('gauge-outline', true).append('rect');\n  bulletOutline.select('rect').call(drawRect).call(styleShape);\n  bulletOutline.exit().remove();\n}\nfunction drawAngularGauge(gd, plotGroup, cd, opts) {\n  var trace = cd[0].trace;\n  var size = opts.size;\n  var radius = opts.radius;\n  var innerRadius = opts.innerRadius;\n  var gaugeBg = opts.gaugeBg;\n  var gaugeOutline = opts.gaugeOutline;\n  var gaugePosition = [size.l + size.w / 2, size.t + size.h / 2 + radius / 2];\n  var gauge = opts.gauge;\n  var axisLayer = opts.layer;\n  var transitionOpts = opts.transitionOpts;\n  var onComplete = opts.onComplete;\n\n  // circular gauge\n  var theta = Math.PI / 2;\n  function valueToAngle(v) {\n    var min = trace.gauge.axis.range[0];\n    var max = trace.gauge.axis.range[1];\n    var angle = (v - min) / (max - min) * Math.PI - theta;\n    if (angle < -theta) return -theta;\n    if (angle > theta) return theta;\n    return angle;\n  }\n  function arcPathGenerator(size) {\n    return d3.svg.arc().innerRadius((innerRadius + radius) / 2 - size / 2 * (radius - innerRadius)).outerRadius((innerRadius + radius) / 2 + size / 2 * (radius - innerRadius)).startAngle(-theta);\n  }\n  function drawArc(p) {\n    p.attr('d', function (d) {\n      return arcPathGenerator(d.thickness).startAngle(valueToAngle(d.range[0])).endAngle(valueToAngle(d.range[1]))();\n    });\n  }\n\n  // preparing axis\n  var ax, vals, transFn, tickSign;\n\n  // Enter gauge and axis\n  gauge.enter().append('g').classed('angular', true);\n  gauge.attr('transform', strTranslate(gaugePosition[0], gaugePosition[1]));\n  axisLayer.enter().append('g').classed('angularaxis', true).classed('crisp', true);\n  axisLayer.selectAll('g.' + 'xangularaxis' + 'tick,path,text').remove();\n  ax = mockAxis(gd, trace.gauge.axis);\n  ax.type = 'linear';\n  ax.range = trace.gauge.axis.range;\n  ax._id = 'xangularaxis'; // or 'y', but I don't think this makes a difference here\n  ax.ticklabeloverflow = 'allow';\n  ax.setScale();\n\n  // 't'ick to 'g'eometric radians is used all over the place here\n  var t2g = function (d) {\n    return (ax.range[0] - d.x) / (ax.range[1] - ax.range[0]) * Math.PI + Math.PI;\n  };\n  var labelFns = {};\n  var out = Axes.makeLabelFns(ax, 0);\n  var labelStandoff = out.labelStandoff;\n  labelFns.xFn = function (d) {\n    var rad = t2g(d);\n    return Math.cos(rad) * labelStandoff;\n  };\n  labelFns.yFn = function (d) {\n    var rad = t2g(d);\n    var ff = Math.sin(rad) > 0 ? 0.2 : 1;\n    return -Math.sin(rad) * (labelStandoff + d.fontSize * ff) + Math.abs(Math.cos(rad)) * (d.fontSize * MID_SHIFT);\n  };\n  labelFns.anchorFn = function (d) {\n    var rad = t2g(d);\n    var cos = Math.cos(rad);\n    return Math.abs(cos) < 0.1 ? 'middle' : cos > 0 ? 'start' : 'end';\n  };\n  labelFns.heightFn = function (d, a, h) {\n    var rad = t2g(d);\n    return -0.5 * (1 + Math.sin(rad)) * h;\n  };\n  var _transFn = function (rad) {\n    return strTranslate(gaugePosition[0] + radius * Math.cos(rad), gaugePosition[1] - radius * Math.sin(rad));\n  };\n  transFn = function (d) {\n    return _transFn(t2g(d));\n  };\n  var transFn2 = function (d) {\n    var rad = t2g(d);\n    return _transFn(rad) + 'rotate(' + -rad2deg(rad) + ')';\n  };\n  vals = Axes.calcTicks(ax);\n  tickSign = Axes.getTickSigns(ax)[2];\n  if (ax.visible) {\n    tickSign = ax.ticks === 'inside' ? -1 : 1;\n    var pad = (ax.linewidth || 1) / 2;\n    Axes.drawTicks(gd, ax, {\n      vals: vals,\n      layer: axisLayer,\n      path: 'M' + tickSign * pad + ',0h' + tickSign * ax.ticklen,\n      transFn: transFn2\n    });\n    Axes.drawLabels(gd, ax, {\n      vals: vals,\n      layer: axisLayer,\n      transFn: transFn,\n      labelFns: labelFns\n    });\n  }\n\n  // Draw background + steps\n  var arcs = [gaugeBg].concat(trace.gauge.steps);\n  var bgArc = gauge.selectAll('g.bg-arc').data(arcs);\n  bgArc.enter().append('g').classed('bg-arc', true).append('path');\n  bgArc.select('path').call(drawArc).call(styleShape);\n  bgArc.exit().remove();\n\n  // Draw foreground with transition\n  var valueArcPathGenerator = arcPathGenerator(trace.gauge.bar.thickness);\n  var valueArc = gauge.selectAll('g.value-arc').data([trace.gauge.bar]);\n  valueArc.enter().append('g').classed('value-arc', true).append('path');\n  var valueArcPath = valueArc.select('path');\n  if (hasTransition(transitionOpts)) {\n    valueArcPath.transition().duration(transitionOpts.duration).ease(transitionOpts.easing).each('end', function () {\n      onComplete && onComplete();\n    }).each('interrupt', function () {\n      onComplete && onComplete();\n    }).attrTween('d', arcTween(valueArcPathGenerator, valueToAngle(cd[0].lastY), valueToAngle(cd[0].y)));\n    trace._lastValue = cd[0].y;\n  } else {\n    valueArcPath.attr('d', typeof cd[0].y === 'number' ? valueArcPathGenerator.endAngle(valueToAngle(cd[0].y)) : 'M0,0Z');\n  }\n  valueArcPath.call(styleShape);\n  valueArc.exit().remove();\n\n  // Draw threshold\n  arcs = [];\n  var v = trace.gauge.threshold.value;\n  if (v || v === 0) {\n    arcs.push({\n      range: [v, v],\n      color: trace.gauge.threshold.color,\n      line: {\n        color: trace.gauge.threshold.line.color,\n        width: trace.gauge.threshold.line.width\n      },\n      thickness: trace.gauge.threshold.thickness\n    });\n  }\n  var thresholdArc = gauge.selectAll('g.threshold-arc').data(arcs);\n  thresholdArc.enter().append('g').classed('threshold-arc', true).append('path');\n  thresholdArc.select('path').call(drawArc).call(styleShape);\n  thresholdArc.exit().remove();\n\n  // Draw border last\n  var gaugeBorder = gauge.selectAll('g.gauge-outline').data([gaugeOutline]);\n  gaugeBorder.enter().append('g').classed('gauge-outline', true).append('path');\n  gaugeBorder.select('path').call(drawArc).call(styleShape);\n  gaugeBorder.exit().remove();\n}\nfunction drawNumbers(gd, plotGroup, cd, opts) {\n  var trace = cd[0].trace;\n  var numbersX = opts.numbersX;\n  var numbersY = opts.numbersY;\n  var numbersAlign = trace.align || 'center';\n  var numbersAnchor = anchor[numbersAlign];\n  var transitionOpts = opts.transitionOpts;\n  var onComplete = opts.onComplete;\n  var numbers = Lib.ensureSingle(plotGroup, 'g', 'numbers');\n  var bignumberbBox, deltabBox;\n  var numbersbBox;\n  var data = [];\n  if (trace._hasNumber) data.push('number');\n  if (trace._hasDelta) {\n    data.push('delta');\n    if (trace.delta.position === 'left') data.reverse();\n  }\n  var sel = numbers.selectAll('text').data(data);\n  sel.enter().append('text');\n  sel.attr('text-anchor', function () {\n    return numbersAnchor;\n  }).attr('class', function (d) {\n    return d;\n  }).attr('x', null).attr('y', null).attr('dx', null).attr('dy', null);\n  sel.exit().remove();\n\n  // Function to override the number formatting used during transitions\n  function transitionFormat(valueformat, fmt, from, to) {\n    // For now, do not display SI prefix if start and end value do not have any\n    if (valueformat.match('s') &&\n    // If using SI prefix\n    from >= 0 !== to >= 0 &&\n    // If sign change\n    !fmt(from).slice(-1).match(SI_PREFIX) && !fmt(to).slice(-1).match(SI_PREFIX) // Has no SI prefix\n    ) {\n      var transitionValueFormat = valueformat.slice().replace('s', 'f').replace(/\\d+/, function (m) {\n        return parseInt(m) - 1;\n      });\n      var transitionAx = mockAxis(gd, {\n        tickformat: transitionValueFormat\n      });\n      return function (v) {\n        // Switch to fixed precision if number is smaller than one\n        if (Math.abs(v) < 1) return Axes.tickText(transitionAx, v).text;\n        return fmt(v);\n      };\n    } else {\n      return fmt;\n    }\n  }\n  function drawBignumber() {\n    var bignumberAx = mockAxis(gd, {\n      tickformat: trace.number.valueformat\n    }, trace._range);\n    bignumberAx.setScale();\n    Axes.prepTicks(bignumberAx);\n    var bignumberFmt = function (v) {\n      return Axes.tickText(bignumberAx, v).text;\n    };\n    var bignumberSuffix = trace.number.suffix;\n    var bignumberPrefix = trace.number.prefix;\n    var number = numbers.select('text.number');\n    function writeNumber() {\n      var txt = typeof cd[0].y === 'number' ? bignumberPrefix + bignumberFmt(cd[0].y) + bignumberSuffix : '-';\n      number.text(txt).call(Drawing.font, trace.number.font).call(svgTextUtils.convertToTspans, gd);\n    }\n    if (hasTransition(transitionOpts)) {\n      number.transition().duration(transitionOpts.duration).ease(transitionOpts.easing).each('end', function () {\n        writeNumber();\n        onComplete && onComplete();\n      }).each('interrupt', function () {\n        writeNumber();\n        onComplete && onComplete();\n      }).attrTween('text', function () {\n        var that = d3.select(this);\n        var interpolator = interpolateNumber(cd[0].lastY, cd[0].y);\n        trace._lastValue = cd[0].y;\n        var transitionFmt = transitionFormat(trace.number.valueformat, bignumberFmt, cd[0].lastY, cd[0].y);\n        return function (t) {\n          that.text(bignumberPrefix + transitionFmt(interpolator(t)) + bignumberSuffix);\n        };\n      });\n    } else {\n      writeNumber();\n    }\n    bignumberbBox = measureText(bignumberPrefix + bignumberFmt(cd[0].y) + bignumberSuffix, trace.number.font, numbersAnchor, gd);\n    return number;\n  }\n  function drawDelta() {\n    var deltaAx = mockAxis(gd, {\n      tickformat: trace.delta.valueformat\n    }, trace._range);\n    deltaAx.setScale();\n    Axes.prepTicks(deltaAx);\n    var deltaFmt = function (v) {\n      return Axes.tickText(deltaAx, v).text;\n    };\n    var deltaSuffix = trace.delta.suffix;\n    var deltaPrefix = trace.delta.prefix;\n    var deltaValue = function (d) {\n      var value = trace.delta.relative ? d.relativeDelta : d.delta;\n      return value;\n    };\n    var deltaFormatText = function (value, numberFmt) {\n      if (value === 0 || typeof value !== 'number' || isNaN(value)) return '-';\n      return (value > 0 ? trace.delta.increasing.symbol : trace.delta.decreasing.symbol) + deltaPrefix + numberFmt(value) + deltaSuffix;\n    };\n    var deltaFill = function (d) {\n      return d.delta >= 0 ? trace.delta.increasing.color : trace.delta.decreasing.color;\n    };\n    if (trace._deltaLastValue === undefined) {\n      trace._deltaLastValue = deltaValue(cd[0]);\n    }\n    var delta = numbers.select('text.delta');\n    delta.call(Drawing.font, trace.delta.font).call(Color.fill, deltaFill({\n      delta: trace._deltaLastValue\n    }));\n    function writeDelta() {\n      delta.text(deltaFormatText(deltaValue(cd[0]), deltaFmt)).call(Color.fill, deltaFill(cd[0])).call(svgTextUtils.convertToTspans, gd);\n    }\n    if (hasTransition(transitionOpts)) {\n      delta.transition().duration(transitionOpts.duration).ease(transitionOpts.easing).tween('text', function () {\n        var that = d3.select(this);\n        var to = deltaValue(cd[0]);\n        var from = trace._deltaLastValue;\n        var transitionFmt = transitionFormat(trace.delta.valueformat, deltaFmt, from, to);\n        var interpolator = interpolateNumber(from, to);\n        trace._deltaLastValue = to;\n        return function (t) {\n          that.text(deltaFormatText(interpolator(t), transitionFmt));\n          that.call(Color.fill, deltaFill({\n            delta: interpolator(t)\n          }));\n        };\n      }).each('end', function () {\n        writeDelta();\n        onComplete && onComplete();\n      }).each('interrupt', function () {\n        writeDelta();\n        onComplete && onComplete();\n      });\n    } else {\n      writeDelta();\n    }\n    deltabBox = measureText(deltaFormatText(deltaValue(cd[0]), deltaFmt), trace.delta.font, numbersAnchor, gd);\n    return delta;\n  }\n  var key = trace.mode + trace.align;\n  var delta;\n  if (trace._hasDelta) {\n    delta = drawDelta();\n    key += trace.delta.position + trace.delta.font.size + trace.delta.font.family + trace.delta.valueformat;\n    key += trace.delta.increasing.symbol + trace.delta.decreasing.symbol;\n    numbersbBox = deltabBox;\n  }\n  if (trace._hasNumber) {\n    drawBignumber();\n    key += trace.number.font.size + trace.number.font.family + trace.number.valueformat + trace.number.suffix + trace.number.prefix;\n    numbersbBox = bignumberbBox;\n  }\n\n  // Position delta relative to bignumber\n  if (trace._hasDelta && trace._hasNumber) {\n    var bignumberCenter = [(bignumberbBox.left + bignumberbBox.right) / 2, (bignumberbBox.top + bignumberbBox.bottom) / 2];\n    var deltaCenter = [(deltabBox.left + deltabBox.right) / 2, (deltabBox.top + deltabBox.bottom) / 2];\n    var dx, dy;\n    var padding = 0.75 * trace.delta.font.size;\n    if (trace.delta.position === 'left') {\n      dx = cache(trace, 'deltaPos', 0, -1 * (bignumberbBox.width * position[trace.align] + deltabBox.width * (1 - position[trace.align]) + padding), key, Math.min);\n      dy = bignumberCenter[1] - deltaCenter[1];\n      numbersbBox = {\n        width: bignumberbBox.width + deltabBox.width + padding,\n        height: Math.max(bignumberbBox.height, deltabBox.height),\n        left: deltabBox.left + dx,\n        right: bignumberbBox.right,\n        top: Math.min(bignumberbBox.top, deltabBox.top + dy),\n        bottom: Math.max(bignumberbBox.bottom, deltabBox.bottom + dy)\n      };\n    }\n    if (trace.delta.position === 'right') {\n      dx = cache(trace, 'deltaPos', 0, bignumberbBox.width * (1 - position[trace.align]) + deltabBox.width * position[trace.align] + padding, key, Math.max);\n      dy = bignumberCenter[1] - deltaCenter[1];\n      numbersbBox = {\n        width: bignumberbBox.width + deltabBox.width + padding,\n        height: Math.max(bignumberbBox.height, deltabBox.height),\n        left: bignumberbBox.left,\n        right: deltabBox.right + dx,\n        top: Math.min(bignumberbBox.top, deltabBox.top + dy),\n        bottom: Math.max(bignumberbBox.bottom, deltabBox.bottom + dy)\n      };\n    }\n    if (trace.delta.position === 'bottom') {\n      dx = null;\n      dy = deltabBox.height;\n      numbersbBox = {\n        width: Math.max(bignumberbBox.width, deltabBox.width),\n        height: bignumberbBox.height + deltabBox.height,\n        left: Math.min(bignumberbBox.left, deltabBox.left),\n        right: Math.max(bignumberbBox.right, deltabBox.right),\n        top: bignumberbBox.bottom - bignumberbBox.height,\n        bottom: bignumberbBox.bottom + deltabBox.height\n      };\n    }\n    if (trace.delta.position === 'top') {\n      dx = null;\n      dy = bignumberbBox.top;\n      numbersbBox = {\n        width: Math.max(bignumberbBox.width, deltabBox.width),\n        height: bignumberbBox.height + deltabBox.height,\n        left: Math.min(bignumberbBox.left, deltabBox.left),\n        right: Math.max(bignumberbBox.right, deltabBox.right),\n        top: bignumberbBox.bottom - bignumberbBox.height - deltabBox.height,\n        bottom: bignumberbBox.bottom\n      };\n    }\n    delta.attr({\n      dx: dx,\n      dy: dy\n    });\n  }\n\n  // Resize numbers to fit within space and position\n  if (trace._hasNumber || trace._hasDelta) {\n    numbers.attr('transform', function () {\n      var m = opts.numbersScaler(numbersbBox);\n      key += m[2];\n      var scaleRatio = cache(trace, 'numbersScale', 1, m[0], key, Math.min);\n      var translateY;\n      if (!trace._scaleNumbers) scaleRatio = 1;\n      if (trace._isAngular) {\n        // align vertically to bottom\n        translateY = numbersY - scaleRatio * numbersbBox.bottom;\n      } else {\n        // align vertically to center\n        translateY = numbersY - scaleRatio * (numbersbBox.top + numbersbBox.bottom) / 2;\n      }\n\n      // Stash the top position of numbersbBox for title positioning\n      trace._numbersTop = scaleRatio * numbersbBox.top + translateY;\n      var ref = numbersbBox[numbersAlign];\n      if (numbersAlign === 'center') ref = (numbersbBox.left + numbersbBox.right) / 2;\n      var translateX = numbersX - scaleRatio * ref;\n\n      // Stash translateX\n      translateX = cache(trace, 'numbersTranslate', 0, translateX, key, Math.max);\n      return strTranslate(translateX, translateY) + strScale(scaleRatio);\n    });\n  }\n}\n\n// Apply fill, stroke, stroke-width to SVG shape\nfunction styleShape(p) {\n  p.each(function (d) {\n    Color.stroke(d3.select(this), d.line.color);\n  }).each(function (d) {\n    Color.fill(d3.select(this), d.color);\n  }).style('stroke-width', function (d) {\n    return d.line.width;\n  });\n}\n\n// Returns a tween for a transition’s \"d\" attribute, transitioning any selected\n// arcs from their current angle to the specified new angle.\nfunction arcTween(arc, endAngle, newAngle) {\n  return function () {\n    var interp = interpolate(endAngle, newAngle);\n    return function (t) {\n      return arc.endAngle(interp(t))();\n    };\n  };\n}\n\n// mocks our axis\nfunction mockAxis(gd, opts, zrange) {\n  var fullLayout = gd._fullLayout;\n  var axisIn = Lib.extendFlat({\n    type: 'linear',\n    ticks: 'outside',\n    range: zrange,\n    showline: true\n  }, opts);\n  var axisOut = {\n    type: 'linear',\n    _id: 'x' + opts._id\n  };\n  var axisOptions = {\n    letter: 'x',\n    font: fullLayout.font,\n    noAutotickangles: true,\n    noHover: true,\n    noTickson: true\n  };\n  function coerce(attr, dflt) {\n    return Lib.coerce(axisIn, axisOut, axisLayoutAttrs, attr, dflt);\n  }\n  handleAxisDefaults(axisIn, axisOut, coerce, axisOptions, fullLayout);\n  handleAxisPositionDefaults(axisIn, axisOut, coerce, axisOptions);\n  return axisOut;\n}\nfunction fitTextInsideBox(textBB, width, height) {\n  // compute scaling ratio to have text fit within specified width and height\n  var ratio = Math.min(width / textBB.width, height / textBB.height);\n  return [ratio, textBB, width + 'x' + height];\n}\nfunction fitTextInsideCircle(textBB, radius) {\n  // compute scaling ratio to have text fit within specified radius\n  var elRadius = Math.sqrt(textBB.width / 2 * (textBB.width / 2) + textBB.height * textBB.height);\n  var ratio = radius / elRadius;\n  return [ratio, textBB, radius];\n}\nfunction measureText(txt, font, textAnchor, gd) {\n  var element = document.createElementNS('http://www.w3.org/2000/svg', 'text');\n  var sel = d3.select(element);\n  sel.text(txt).attr('x', 0).attr('y', 0).attr('text-anchor', textAnchor).attr('data-unformatted', txt).call(svgTextUtils.convertToTspans, gd).call(Drawing.font, font);\n  return Drawing.bBox(sel.node());\n}\nfunction cache(trace, name, initialValue, value, key, fn) {\n  var objName = '_cache' + name;\n  if (!(trace[objName] && trace[objName].key === key)) {\n    trace[objName] = {\n      key: key,\n      value: initialValue\n    };\n  }\n  var v = Lib.aggNums(fn, null, [trace[objName].value, value], 2);\n  trace[objName].value = v;\n  return v;\n}","map":{"version":3,"names":["d3","require","interpolate","interpolateNumber","Lib","strScale","strTranslate","rad2deg","MID_SHIFT","Drawing","cn","svgTextUtils","Axes","handleAxisDefaults","handleAxisPositionDefaults","axisLayoutAttrs","Color","anchor","left","center","right","position","SI_PREFIX","hasTransition","transitionOpts","duration","module","exports","plot","gd","cdModule","makeOnCompleteCallback","fullLayout","_fullLayout","onComplete","makeTraceGroups","_indicatorlayer","each","cd","cd0","trace","plotGroup","select","hasGauge","_hasGauge","isAngular","_isAngular","isBullet","_isBullet","domain","size","w","_size","x","h","y","l","r","t","b","centerX","centerY","radius","Math","min","innerRadius","numbersX","numbersY","numbersScaler","numbersAlign","align","el","fitTextInsideBox","fitTextInsideCircle","padding","bulletPadding","p","bulletNumberDomainSize","drawNumbers","gaugeBg","gaugeOutline","range","gauge","axis","color","bgcolor","line","bordercolor","width","thickness","borderwidth","angularGauge","selectAll","data","exit","remove","angularaxisLayer","drawAngularGauge","layer","bulletGauge","bulletaxisLayer","drawBulletGauge","title","enter","append","classed","attr","text","call","font","convertToTspans","titleX","titleY","titlePadding","titlebBox","bBox","node","visible","top","bottom","_numbersTop","opts","bullet","axisLayer","ax","vals","transFn","tickSign","shift","bulletHeight","innerBulletHeight","bar","bulletLeft","bulletRight","_hasNumber","_hasDelta","mockAxis","_id","setScale","calcTicks","makeTransTickFn","getTickSigns","drawTicks","ticks","clipEnds","path","makeTickPath","drawLabels","labelFns","makeLabelFns","drawRect","s","d","max","c2p","boxes","concat","steps","bgBullet","styleShape","fgBullet","transition","ease","easing","filter","threshold","value","stroke","style","bulletOutline","gaugePosition","theta","PI","valueToAngle","v","angle","arcPathGenerator","svg","arc","outerRadius","startAngle","drawArc","endAngle","type","ticklabeloverflow","t2g","out","labelStandoff","xFn","rad","cos","yFn","ff","sin","fontSize","abs","anchorFn","heightFn","a","_transFn","transFn2","pad","linewidth","ticklen","arcs","bgArc","valueArcPathGenerator","valueArc","valueArcPath","attrTween","arcTween","lastY","_lastValue","push","thresholdArc","gaugeBorder","numbersAnchor","numbers","ensureSingle","bignumberbBox","deltabBox","numbersbBox","delta","reverse","sel","transitionFormat","valueformat","fmt","from","to","match","slice","transitionValueFormat","replace","m","parseInt","transitionAx","tickformat","tickText","drawBignumber","bignumberAx","number","_range","prepTicks","bignumberFmt","bignumberSuffix","suffix","bignumberPrefix","prefix","writeNumber","txt","that","interpolator","transitionFmt","measureText","drawDelta","deltaAx","deltaFmt","deltaSuffix","deltaPrefix","deltaValue","relative","relativeDelta","deltaFormatText","numberFmt","isNaN","increasing","symbol","decreasing","deltaFill","_deltaLastValue","undefined","fill","writeDelta","tween","key","mode","family","bignumberCenter","deltaCenter","dx","dy","cache","height","scaleRatio","translateY","_scaleNumbers","ref","translateX","newAngle","interp","zrange","axisIn","extendFlat","showline","axisOut","axisOptions","letter","noAutotickangles","noHover","noTickson","coerce","dflt","textBB","ratio","elRadius","sqrt","textAnchor","element","document","createElementNS","name","initialValue","fn","objName","aggNums"],"sources":["E:/tog_workspace/TestFabric_main/TestFabric-main/node_modules/plotly.js/src/traces/indicator/plot.js"],"sourcesContent":["'use strict';\n\nvar d3 = require('@plotly/d3');\nvar interpolate = require('d3-interpolate').interpolate;\nvar interpolateNumber = require('d3-interpolate').interpolateNumber;\n\nvar Lib = require('../../lib');\nvar strScale = Lib.strScale;\nvar strTranslate = Lib.strTranslate;\nvar rad2deg = Lib.rad2deg;\nvar MID_SHIFT = require('../../constants/alignment').MID_SHIFT;\nvar Drawing = require('../../components/drawing');\nvar cn = require('./constants');\nvar svgTextUtils = require('../../lib/svg_text_utils');\n\nvar Axes = require('../../plots/cartesian/axes');\nvar handleAxisDefaults = require('../../plots/cartesian/axis_defaults');\nvar handleAxisPositionDefaults = require('../../plots/cartesian/position_defaults');\nvar axisLayoutAttrs = require('../../plots/cartesian/layout_attributes');\n\nvar Color = require('../../components/color');\nvar anchor = {\n    left: 'start',\n    center: 'middle',\n    right: 'end'\n};\nvar position = {\n    left: 0,\n    center: 0.5,\n    right: 1\n};\n\nvar SI_PREFIX = /[yzafpnµmkMGTPEZY]/;\n\nfunction hasTransition(transitionOpts) {\n    // If transition config is provided, then it is only a partial replot and traces not\n    // updated are removed.\n    return transitionOpts && transitionOpts.duration > 0;\n}\n\nmodule.exports = function plot(gd, cdModule, transitionOpts, makeOnCompleteCallback) {\n    var fullLayout = gd._fullLayout;\n    var onComplete;\n\n    if(hasTransition(transitionOpts)) {\n        if(makeOnCompleteCallback) {\n            // If it was passed a callback to register completion, make a callback. If\n            // this is created, then it must be executed on completion, otherwise the\n            // pos-transition redraw will not execute:\n            onComplete = makeOnCompleteCallback();\n        }\n    }\n\n    Lib.makeTraceGroups(fullLayout._indicatorlayer, cdModule, 'trace').each(function(cd) {\n        var cd0 = cd[0];\n        var trace = cd0.trace;\n\n        var plotGroup = d3.select(this);\n\n        // Elements in trace\n        var hasGauge = trace._hasGauge;\n        var isAngular = trace._isAngular;\n        var isBullet = trace._isBullet;\n\n        // Domain size\n        var domain = trace.domain;\n        var size = {\n            w: fullLayout._size.w * (domain.x[1] - domain.x[0]),\n            h: fullLayout._size.h * (domain.y[1] - domain.y[0]),\n            l: fullLayout._size.l + fullLayout._size.w * domain.x[0],\n            r: fullLayout._size.r + fullLayout._size.w * (1 - domain.x[1]),\n            t: fullLayout._size.t + fullLayout._size.h * (1 - domain.y[1]),\n            b: fullLayout._size.b + fullLayout._size.h * (domain.y[0])\n        };\n        var centerX = size.l + size.w / 2;\n        var centerY = size.t + size.h / 2;\n\n        // Angular gauge size\n        var radius = Math.min(size.w / 2, size.h); // fill domain\n        var innerRadius = cn.innerRadius * radius;\n\n        // Position numbers based on mode and set the scaling logic\n        var numbersX, numbersY, numbersScaler;\n        var numbersAlign = trace.align || 'center';\n\n        numbersY = centerY;\n        if(!hasGauge) {\n            numbersX = size.l + position[numbersAlign] * size.w;\n            numbersScaler = function(el) {\n                return fitTextInsideBox(el, size.w, size.h);\n            };\n        } else {\n            if(isAngular) {\n                numbersX = centerX;\n                numbersY = centerY + radius / 2;\n                numbersScaler = function(el) {\n                    return fitTextInsideCircle(el, 0.9 * innerRadius);\n                };\n            }\n            if(isBullet) {\n                var padding = cn.bulletPadding;\n                var p = (1 - cn.bulletNumberDomainSize) + padding;\n                numbersX = size.l + (p + (1 - p) * position[numbersAlign]) * size.w;\n                numbersScaler = function(el) {\n                    return fitTextInsideBox(el, (cn.bulletNumberDomainSize - padding) * size.w, size.h);\n                };\n            }\n        }\n\n        // Draw numbers\n        drawNumbers(gd, plotGroup, cd, {\n            numbersX: numbersX,\n            numbersY: numbersY,\n            numbersScaler: numbersScaler,\n            transitionOpts: transitionOpts,\n            onComplete: onComplete\n        });\n\n        // Reexpress our gauge background attributes for drawing\n        var gaugeBg, gaugeOutline;\n        if(hasGauge) {\n            gaugeBg = {\n                range: trace.gauge.axis.range,\n                color: trace.gauge.bgcolor,\n                line: {\n                    color: trace.gauge.bordercolor,\n                    width: 0\n                },\n                thickness: 1\n            };\n\n            gaugeOutline = {\n                range: trace.gauge.axis.range,\n                color: 'rgba(0, 0, 0, 0)',\n                line: {\n                    color: trace.gauge.bordercolor,\n                    width: trace.gauge.borderwidth\n                },\n                thickness: 1\n            };\n        }\n\n        // Prepare angular gauge layers\n        var angularGauge = plotGroup.selectAll('g.angular').data(isAngular ? cd : []);\n        angularGauge.exit().remove();\n        var angularaxisLayer = plotGroup.selectAll('g.angularaxis').data(isAngular ? cd : []);\n        angularaxisLayer.exit().remove();\n\n        if(isAngular) {\n            drawAngularGauge(gd, plotGroup, cd, {\n                radius: radius,\n                innerRadius: innerRadius,\n\n                gauge: angularGauge,\n                layer: angularaxisLayer,\n                size: size,\n                gaugeBg: gaugeBg,\n                gaugeOutline: gaugeOutline,\n                transitionOpts: transitionOpts,\n                onComplete: onComplete\n            });\n        }\n\n        // Prepare bullet layers\n        var bulletGauge = plotGroup.selectAll('g.bullet').data(isBullet ? cd : []);\n        bulletGauge.exit().remove();\n        var bulletaxisLayer = plotGroup.selectAll('g.bulletaxis').data(isBullet ? cd : []);\n        bulletaxisLayer.exit().remove();\n\n        if(isBullet) {\n            drawBulletGauge(gd, plotGroup, cd, {\n                gauge: bulletGauge,\n                layer: bulletaxisLayer,\n                size: size,\n                gaugeBg: gaugeBg,\n                gaugeOutline: gaugeOutline,\n                transitionOpts: transitionOpts,\n                onComplete: onComplete\n            });\n        }\n\n        // title\n        var title = plotGroup.selectAll('text.title').data(cd);\n        title.exit().remove();\n        title.enter().append('text').classed('title', true);\n        title\n            .attr('text-anchor', function() {\n                return isBullet ? anchor.right : anchor[trace.title.align];\n            })\n            .text(trace.title.text)\n            .call(Drawing.font, trace.title.font)\n            .call(svgTextUtils.convertToTspans, gd);\n\n        // Position title\n        title.attr('transform', function() {\n            var titleX = size.l + size.w * position[trace.title.align];\n            var titleY;\n            var titlePadding = cn.titlePadding;\n            var titlebBox = Drawing.bBox(title.node());\n            if(hasGauge) {\n                if(isAngular) {\n                    // position above axis ticks/labels\n                    if(trace.gauge.axis.visible) {\n                        var bBox = Drawing.bBox(angularaxisLayer.node());\n                        titleY = (bBox.top - titlePadding) - titlebBox.bottom;\n                    } else {\n                        titleY = size.t + size.h / 2 - radius / 2 - titlebBox.bottom - titlePadding;\n                    }\n                }\n                if(isBullet) {\n                    // position outside domain\n                    titleY = numbersY - (titlebBox.top + titlebBox.bottom) / 2;\n                    titleX = size.l - cn.bulletPadding * size.w; // Outside domain, on the left\n                }\n            } else {\n                // position above numbers\n                titleY = (trace._numbersTop - titlePadding) - titlebBox.bottom;\n            }\n            return strTranslate(titleX, titleY);\n        });\n    });\n};\n\nfunction drawBulletGauge(gd, plotGroup, cd, opts) {\n    var trace = cd[0].trace;\n\n    var bullet = opts.gauge;\n    var axisLayer = opts.layer;\n    var gaugeBg = opts.gaugeBg;\n    var gaugeOutline = opts.gaugeOutline;\n    var size = opts.size;\n    var domain = trace.domain;\n\n    var transitionOpts = opts.transitionOpts;\n    var onComplete = opts.onComplete;\n\n    // preparing axis\n    var ax, vals, transFn, tickSign, shift;\n\n    // Enter bullet, axis\n    bullet.enter().append('g').classed('bullet', true);\n    bullet.attr('transform', strTranslate(size.l, size.t));\n\n    axisLayer.enter().append('g')\n        .classed('bulletaxis', true)\n        .classed('crisp', true);\n    axisLayer.selectAll('g.' + 'xbulletaxis' + 'tick,path,text').remove();\n\n    // Draw bullet\n    var bulletHeight = size.h; // use all vertical domain\n    var innerBulletHeight = trace.gauge.bar.thickness * bulletHeight;\n    var bulletLeft = domain.x[0];\n    var bulletRight = domain.x[0] + (domain.x[1] - domain.x[0]) * ((trace._hasNumber || trace._hasDelta) ? (1 - cn.bulletNumberDomainSize) : 1);\n\n    ax = mockAxis(gd, trace.gauge.axis);\n    ax._id = 'xbulletaxis';\n    ax.domain = [bulletLeft, bulletRight];\n    ax.setScale();\n\n    vals = Axes.calcTicks(ax);\n    transFn = Axes.makeTransTickFn(ax);\n    tickSign = Axes.getTickSigns(ax)[2];\n\n    shift = size.t + size.h;\n    if(ax.visible) {\n        Axes.drawTicks(gd, ax, {\n            vals: ax.ticks === 'inside' ? Axes.clipEnds(ax, vals) : vals,\n            layer: axisLayer,\n            path: Axes.makeTickPath(ax, shift, tickSign),\n            transFn: transFn\n        });\n\n        Axes.drawLabels(gd, ax, {\n            vals: vals,\n            layer: axisLayer,\n            transFn: transFn,\n            labelFns: Axes.makeLabelFns(ax, shift)\n        });\n    }\n\n    function drawRect(s) {\n        s\n            .attr('width', function(d) { return Math.max(0, ax.c2p(d.range[1]) - ax.c2p(d.range[0]));})\n            .attr('x', function(d) { return ax.c2p(d.range[0]);})\n            .attr('y', function(d) { return 0.5 * (1 - d.thickness) * bulletHeight;})\n            .attr('height', function(d) { return d.thickness * bulletHeight; });\n    }\n\n    // Draw bullet background, steps\n    var boxes = [gaugeBg].concat(trace.gauge.steps);\n    var bgBullet = bullet.selectAll('g.bg-bullet').data(boxes);\n    bgBullet.enter().append('g').classed('bg-bullet', true).append('rect');\n    bgBullet.select('rect')\n        .call(drawRect)\n        .call(styleShape);\n    bgBullet.exit().remove();\n\n    // Draw value bar with transitions\n    var fgBullet = bullet.selectAll('g.value-bullet').data([trace.gauge.bar]);\n    fgBullet.enter().append('g').classed('value-bullet', true).append('rect');\n    fgBullet.select('rect')\n        .attr('height', innerBulletHeight)\n        .attr('y', (bulletHeight - innerBulletHeight) / 2)\n        .call(styleShape);\n    if(hasTransition(transitionOpts)) {\n        fgBullet.select('rect')\n            .transition()\n            .duration(transitionOpts.duration)\n            .ease(transitionOpts.easing)\n            .each('end', function() { onComplete && onComplete(); })\n            .each('interrupt', function() { onComplete && onComplete(); })\n            .attr('width', Math.max(0, ax.c2p(Math.min(trace.gauge.axis.range[1], cd[0].y))));\n    } else {\n        fgBullet.select('rect')\n            .attr('width', typeof cd[0].y === 'number' ?\n                Math.max(0, ax.c2p(Math.min(trace.gauge.axis.range[1], cd[0].y))) :\n                0);\n    }\n    fgBullet.exit().remove();\n\n    var data = cd.filter(function() {return trace.gauge.threshold.value || trace.gauge.threshold.value === 0;});\n    var threshold = bullet.selectAll('g.threshold-bullet').data(data);\n    threshold.enter().append('g').classed('threshold-bullet', true).append('line');\n    threshold.select('line')\n        .attr('x1', ax.c2p(trace.gauge.threshold.value))\n        .attr('x2', ax.c2p(trace.gauge.threshold.value))\n        .attr('y1', (1 - trace.gauge.threshold.thickness) / 2 * bulletHeight)\n        .attr('y2', (1 - (1 - trace.gauge.threshold.thickness) / 2) * bulletHeight)\n        .call(Color.stroke, trace.gauge.threshold.line.color)\n        .style('stroke-width', trace.gauge.threshold.line.width);\n    threshold.exit().remove();\n\n    var bulletOutline = bullet.selectAll('g.gauge-outline').data([gaugeOutline]);\n    bulletOutline.enter().append('g').classed('gauge-outline', true).append('rect');\n    bulletOutline.select('rect')\n        .call(drawRect)\n        .call(styleShape);\n    bulletOutline.exit().remove();\n}\n\nfunction drawAngularGauge(gd, plotGroup, cd, opts) {\n    var trace = cd[0].trace;\n\n    var size = opts.size;\n    var radius = opts.radius;\n    var innerRadius = opts.innerRadius;\n    var gaugeBg = opts.gaugeBg;\n    var gaugeOutline = opts.gaugeOutline;\n    var gaugePosition = [size.l + size.w / 2, size.t + size.h / 2 + radius / 2];\n    var gauge = opts.gauge;\n    var axisLayer = opts.layer;\n\n    var transitionOpts = opts.transitionOpts;\n    var onComplete = opts.onComplete;\n\n    // circular gauge\n    var theta = Math.PI / 2;\n    function valueToAngle(v) {\n        var min = trace.gauge.axis.range[0];\n        var max = trace.gauge.axis.range[1];\n        var angle = (v - min) / (max - min) * Math.PI - theta;\n        if(angle < -theta) return -theta;\n        if(angle > theta) return theta;\n        return angle;\n    }\n\n    function arcPathGenerator(size) {\n        return d3.svg.arc()\n                  .innerRadius((innerRadius + radius) / 2 - size / 2 * (radius - innerRadius))\n                  .outerRadius((innerRadius + radius) / 2 + size / 2 * (radius - innerRadius))\n                  .startAngle(-theta);\n    }\n\n    function drawArc(p) {\n        p\n            .attr('d', function(d) {\n                return arcPathGenerator(d.thickness)\n                  .startAngle(valueToAngle(d.range[0]))\n                  .endAngle(valueToAngle(d.range[1]))();\n            });\n    }\n\n    // preparing axis\n    var ax, vals, transFn, tickSign;\n\n    // Enter gauge and axis\n    gauge.enter().append('g').classed('angular', true);\n    gauge.attr('transform', strTranslate(gaugePosition[0], gaugePosition[1]));\n\n    axisLayer.enter().append('g')\n        .classed('angularaxis', true)\n        .classed('crisp', true);\n    axisLayer.selectAll('g.' + 'xangularaxis' + 'tick,path,text').remove();\n\n    ax = mockAxis(gd, trace.gauge.axis);\n    ax.type = 'linear';\n    ax.range = trace.gauge.axis.range;\n    ax._id = 'xangularaxis'; // or 'y', but I don't think this makes a difference here\n    ax.ticklabeloverflow = 'allow';\n    ax.setScale();\n\n    // 't'ick to 'g'eometric radians is used all over the place here\n    var t2g = function(d) {\n        return (ax.range[0] - d.x) / (ax.range[1] - ax.range[0]) * Math.PI + Math.PI;\n    };\n\n    var labelFns = {};\n    var out = Axes.makeLabelFns(ax, 0);\n    var labelStandoff = out.labelStandoff;\n    labelFns.xFn = function(d) {\n        var rad = t2g(d);\n        return Math.cos(rad) * labelStandoff;\n    };\n    labelFns.yFn = function(d) {\n        var rad = t2g(d);\n        var ff = Math.sin(rad) > 0 ? 0.2 : 1;\n        return -Math.sin(rad) * (labelStandoff + d.fontSize * ff) +\n                Math.abs(Math.cos(rad)) * (d.fontSize * MID_SHIFT);\n    };\n    labelFns.anchorFn = function(d) {\n        var rad = t2g(d);\n        var cos = Math.cos(rad);\n        return Math.abs(cos) < 0.1 ?\n                'middle' :\n                (cos > 0 ? 'start' : 'end');\n    };\n    labelFns.heightFn = function(d, a, h) {\n        var rad = t2g(d);\n        return -0.5 * (1 + Math.sin(rad)) * h;\n    };\n    var _transFn = function(rad) {\n        return strTranslate(\n            gaugePosition[0] + radius * Math.cos(rad),\n            gaugePosition[1] - radius * Math.sin(rad)\n        );\n    };\n    transFn = function(d) {\n        return _transFn(t2g(d));\n    };\n    var transFn2 = function(d) {\n        var rad = t2g(d);\n        return _transFn(rad) + 'rotate(' + -rad2deg(rad) + ')';\n    };\n    vals = Axes.calcTicks(ax);\n    tickSign = Axes.getTickSigns(ax)[2];\n    if(ax.visible) {\n        tickSign = ax.ticks === 'inside' ? -1 : 1;\n        var pad = (ax.linewidth || 1) / 2;\n        Axes.drawTicks(gd, ax, {\n            vals: vals,\n            layer: axisLayer,\n            path: 'M' + (tickSign * pad) + ',0h' + (tickSign * ax.ticklen),\n            transFn: transFn2\n        });\n        Axes.drawLabels(gd, ax, {\n            vals: vals,\n            layer: axisLayer,\n            transFn: transFn,\n            labelFns: labelFns\n        });\n    }\n\n    // Draw background + steps\n    var arcs = [gaugeBg].concat(trace.gauge.steps);\n    var bgArc = gauge.selectAll('g.bg-arc').data(arcs);\n    bgArc.enter().append('g').classed('bg-arc', true).append('path');\n    bgArc.select('path').call(drawArc).call(styleShape);\n    bgArc.exit().remove();\n\n    // Draw foreground with transition\n    var valueArcPathGenerator = arcPathGenerator(trace.gauge.bar.thickness);\n    var valueArc = gauge.selectAll('g.value-arc').data([trace.gauge.bar]);\n    valueArc.enter().append('g').classed('value-arc', true).append('path');\n    var valueArcPath = valueArc.select('path');\n    if(hasTransition(transitionOpts)) {\n        valueArcPath\n            .transition()\n            .duration(transitionOpts.duration)\n            .ease(transitionOpts.easing)\n            .each('end', function() { onComplete && onComplete(); })\n            .each('interrupt', function() { onComplete && onComplete(); })\n            .attrTween('d', arcTween(valueArcPathGenerator, valueToAngle(cd[0].lastY), valueToAngle(cd[0].y)));\n        trace._lastValue = cd[0].y;\n    } else {\n        valueArcPath.attr('d', typeof cd[0].y === 'number' ?\n            valueArcPathGenerator.endAngle(valueToAngle(cd[0].y)) :\n            'M0,0Z');\n    }\n    valueArcPath.call(styleShape);\n    valueArc.exit().remove();\n\n    // Draw threshold\n    arcs = [];\n    var v = trace.gauge.threshold.value;\n    if(v || v === 0) {\n        arcs.push({\n            range: [v, v],\n            color: trace.gauge.threshold.color,\n            line: {\n                color: trace.gauge.threshold.line.color,\n                width: trace.gauge.threshold.line.width\n            },\n            thickness: trace.gauge.threshold.thickness\n        });\n    }\n    var thresholdArc = gauge.selectAll('g.threshold-arc').data(arcs);\n    thresholdArc.enter().append('g').classed('threshold-arc', true).append('path');\n    thresholdArc.select('path').call(drawArc).call(styleShape);\n    thresholdArc.exit().remove();\n\n    // Draw border last\n    var gaugeBorder = gauge.selectAll('g.gauge-outline').data([gaugeOutline]);\n    gaugeBorder.enter().append('g').classed('gauge-outline', true).append('path');\n    gaugeBorder.select('path').call(drawArc).call(styleShape);\n    gaugeBorder.exit().remove();\n}\n\nfunction drawNumbers(gd, plotGroup, cd, opts) {\n    var trace = cd[0].trace;\n\n    var numbersX = opts.numbersX;\n    var numbersY = opts.numbersY;\n    var numbersAlign = trace.align || 'center';\n    var numbersAnchor = anchor[numbersAlign];\n\n    var transitionOpts = opts.transitionOpts;\n    var onComplete = opts.onComplete;\n\n    var numbers = Lib.ensureSingle(plotGroup, 'g', 'numbers');\n    var bignumberbBox, deltabBox;\n    var numbersbBox;\n\n    var data = [];\n    if(trace._hasNumber) data.push('number');\n    if(trace._hasDelta) {\n        data.push('delta');\n        if(trace.delta.position === 'left') data.reverse();\n    }\n    var sel = numbers.selectAll('text').data(data);\n    sel.enter().append('text');\n    sel\n        .attr('text-anchor', function() {return numbersAnchor;})\n        .attr('class', function(d) { return d;})\n        .attr('x', null)\n        .attr('y', null)\n        .attr('dx', null)\n        .attr('dy', null);\n    sel.exit().remove();\n\n    // Function to override the number formatting used during transitions\n    function transitionFormat(valueformat, fmt, from, to) {\n        // For now, do not display SI prefix if start and end value do not have any\n        if(valueformat.match('s') && // If using SI prefix\n            (from >= 0 !== to >= 0) && // If sign change\n            (!fmt(from).slice(-1).match(SI_PREFIX) && !fmt(to).slice(-1).match(SI_PREFIX)) // Has no SI prefix\n        ) {\n            var transitionValueFormat = valueformat.slice().replace('s', 'f').replace(/\\d+/, function(m) { return parseInt(m) - 1;});\n            var transitionAx = mockAxis(gd, {tickformat: transitionValueFormat});\n            return function(v) {\n                // Switch to fixed precision if number is smaller than one\n                if(Math.abs(v) < 1) return Axes.tickText(transitionAx, v).text;\n                return fmt(v);\n            };\n        } else {\n            return fmt;\n        }\n    }\n\n    function drawBignumber() {\n        var bignumberAx = mockAxis(gd, {tickformat: trace.number.valueformat}, trace._range);\n        bignumberAx.setScale();\n        Axes.prepTicks(bignumberAx);\n\n        var bignumberFmt = function(v) { return Axes.tickText(bignumberAx, v).text;};\n        var bignumberSuffix = trace.number.suffix;\n        var bignumberPrefix = trace.number.prefix;\n\n        var number = numbers.select('text.number');\n\n        function writeNumber() {\n            var txt = typeof cd[0].y === 'number' ?\n                bignumberPrefix + bignumberFmt(cd[0].y) + bignumberSuffix :\n                '-';\n            number.text(txt)\n                .call(Drawing.font, trace.number.font)\n                .call(svgTextUtils.convertToTspans, gd);\n        }\n\n        if(hasTransition(transitionOpts)) {\n            number\n                .transition()\n                .duration(transitionOpts.duration)\n                .ease(transitionOpts.easing)\n                .each('end', function() { writeNumber(); onComplete && onComplete(); })\n                .each('interrupt', function() { writeNumber(); onComplete && onComplete(); })\n                .attrTween('text', function() {\n                    var that = d3.select(this);\n                    var interpolator = interpolateNumber(cd[0].lastY, cd[0].y);\n                    trace._lastValue = cd[0].y;\n\n                    var transitionFmt = transitionFormat(trace.number.valueformat, bignumberFmt, cd[0].lastY, cd[0].y);\n                    return function(t) {\n                        that.text(bignumberPrefix + transitionFmt(interpolator(t)) + bignumberSuffix);\n                    };\n                });\n        } else {\n            writeNumber();\n        }\n\n        bignumberbBox = measureText(bignumberPrefix + bignumberFmt(cd[0].y) + bignumberSuffix, trace.number.font, numbersAnchor, gd);\n        return number;\n    }\n\n    function drawDelta() {\n        var deltaAx = mockAxis(gd, {tickformat: trace.delta.valueformat}, trace._range);\n        deltaAx.setScale();\n        Axes.prepTicks(deltaAx);\n\n        var deltaFmt = function(v) { return Axes.tickText(deltaAx, v).text;};\n        var deltaSuffix = trace.delta.suffix;\n        var deltaPrefix = trace.delta.prefix;\n\n        var deltaValue = function(d) {\n            var value = trace.delta.relative ? d.relativeDelta : d.delta;\n            return value;\n        };\n        var deltaFormatText = function(value, numberFmt) {\n            if(value === 0 || typeof value !== 'number' || isNaN(value)) return '-';\n            return (value > 0 ? trace.delta.increasing.symbol : trace.delta.decreasing.symbol) + deltaPrefix + numberFmt(value) + deltaSuffix;\n        };\n        var deltaFill = function(d) {\n            return d.delta >= 0 ? trace.delta.increasing.color : trace.delta.decreasing.color;\n        };\n        if(trace._deltaLastValue === undefined) {\n            trace._deltaLastValue = deltaValue(cd[0]);\n        }\n        var delta = numbers.select('text.delta');\n        delta\n            .call(Drawing.font, trace.delta.font)\n            .call(Color.fill, deltaFill({delta: trace._deltaLastValue}));\n\n        function writeDelta() {\n            delta.text(deltaFormatText(deltaValue(cd[0]), deltaFmt))\n                .call(Color.fill, deltaFill(cd[0]))\n                .call(svgTextUtils.convertToTspans, gd);\n        }\n\n        if(hasTransition(transitionOpts)) {\n            delta\n                .transition()\n                .duration(transitionOpts.duration)\n                .ease(transitionOpts.easing)\n                .tween('text', function() {\n                    var that = d3.select(this);\n                    var to = deltaValue(cd[0]);\n                    var from = trace._deltaLastValue;\n                    var transitionFmt = transitionFormat(trace.delta.valueformat, deltaFmt, from, to);\n                    var interpolator = interpolateNumber(from, to);\n                    trace._deltaLastValue = to;\n                    return function(t) {\n                        that.text(deltaFormatText(interpolator(t), transitionFmt));\n                        that.call(Color.fill, deltaFill({delta: interpolator(t)}));\n                    };\n                })\n                .each('end', function() { writeDelta(); onComplete && onComplete(); })\n                .each('interrupt', function() { writeDelta(); onComplete && onComplete(); });\n        } else {\n            writeDelta();\n        }\n\n        deltabBox = measureText(deltaFormatText(deltaValue(cd[0]), deltaFmt), trace.delta.font, numbersAnchor, gd);\n        return delta;\n    }\n\n    var key = trace.mode + trace.align;\n    var delta;\n    if(trace._hasDelta) {\n        delta = drawDelta();\n        key += trace.delta.position + trace.delta.font.size + trace.delta.font.family + trace.delta.valueformat;\n        key += trace.delta.increasing.symbol + trace.delta.decreasing.symbol;\n        numbersbBox = deltabBox;\n    }\n    if(trace._hasNumber) {\n        drawBignumber();\n        key += trace.number.font.size + trace.number.font.family + trace.number.valueformat + trace.number.suffix + trace.number.prefix;\n        numbersbBox = bignumberbBox;\n    }\n\n    // Position delta relative to bignumber\n    if(trace._hasDelta && trace._hasNumber) {\n        var bignumberCenter = [\n            (bignumberbBox.left + bignumberbBox.right) / 2,\n            (bignumberbBox.top + bignumberbBox.bottom) / 2\n        ];\n        var deltaCenter = [\n            (deltabBox.left + deltabBox.right) / 2,\n            (deltabBox.top + deltabBox.bottom) / 2\n        ];\n\n        var dx, dy;\n        var padding = 0.75 * trace.delta.font.size;\n        if(trace.delta.position === 'left') {\n            dx = cache(trace, 'deltaPos', 0, -1 * (bignumberbBox.width * (position[trace.align]) + deltabBox.width * (1 - position[trace.align]) + padding), key, Math.min);\n            dy = bignumberCenter[1] - deltaCenter[1];\n\n            numbersbBox = {\n                width: bignumberbBox.width + deltabBox.width + padding,\n                height: Math.max(bignumberbBox.height, deltabBox.height),\n                left: deltabBox.left + dx,\n                right: bignumberbBox.right,\n                top: Math.min(bignumberbBox.top, deltabBox.top + dy),\n                bottom: Math.max(bignumberbBox.bottom, deltabBox.bottom + dy)\n            };\n        }\n        if(trace.delta.position === 'right') {\n            dx = cache(trace, 'deltaPos', 0, bignumberbBox.width * (1 - position[trace.align]) + deltabBox.width * position[trace.align] + padding, key, Math.max);\n            dy = bignumberCenter[1] - deltaCenter[1];\n\n            numbersbBox = {\n                width: bignumberbBox.width + deltabBox.width + padding,\n                height: Math.max(bignumberbBox.height, deltabBox.height),\n                left: bignumberbBox.left,\n                right: deltabBox.right + dx,\n                top: Math.min(bignumberbBox.top, deltabBox.top + dy),\n                bottom: Math.max(bignumberbBox.bottom, deltabBox.bottom + dy)\n            };\n        }\n        if(trace.delta.position === 'bottom') {\n            dx = null;\n            dy = deltabBox.height;\n\n            numbersbBox = {\n                width: Math.max(bignumberbBox.width, deltabBox.width),\n                height: bignumberbBox.height + deltabBox.height,\n                left: Math.min(bignumberbBox.left, deltabBox.left),\n                right: Math.max(bignumberbBox.right, deltabBox.right),\n                top: bignumberbBox.bottom - bignumberbBox.height,\n                bottom: bignumberbBox.bottom + deltabBox.height\n            };\n        }\n        if(trace.delta.position === 'top') {\n            dx = null;\n            dy = bignumberbBox.top;\n\n            numbersbBox = {\n                width: Math.max(bignumberbBox.width, deltabBox.width),\n                height: bignumberbBox.height + deltabBox.height,\n                left: Math.min(bignumberbBox.left, deltabBox.left),\n                right: Math.max(bignumberbBox.right, deltabBox.right),\n                top: bignumberbBox.bottom - bignumberbBox.height - deltabBox.height,\n                bottom: bignumberbBox.bottom\n            };\n        }\n\n        delta.attr({dx: dx, dy: dy});\n    }\n\n    // Resize numbers to fit within space and position\n    if(trace._hasNumber || trace._hasDelta) {\n        numbers.attr('transform', function() {\n            var m = opts.numbersScaler(numbersbBox);\n            key += m[2];\n            var scaleRatio = cache(trace, 'numbersScale', 1, m[0], key, Math.min);\n            var translateY;\n            if(!trace._scaleNumbers) scaleRatio = 1;\n            if(trace._isAngular) {\n                // align vertically to bottom\n                translateY = numbersY - scaleRatio * numbersbBox.bottom;\n            } else {\n                // align vertically to center\n                translateY = numbersY - scaleRatio * (numbersbBox.top + numbersbBox.bottom) / 2;\n            }\n\n            // Stash the top position of numbersbBox for title positioning\n            trace._numbersTop = scaleRatio * (numbersbBox.top) + translateY;\n\n            var ref = numbersbBox[numbersAlign];\n            if(numbersAlign === 'center') ref = (numbersbBox.left + numbersbBox.right) / 2;\n            var translateX = numbersX - scaleRatio * ref;\n\n            // Stash translateX\n            translateX = cache(trace, 'numbersTranslate', 0, translateX, key, Math.max);\n            return strTranslate(translateX, translateY) + strScale(scaleRatio);\n        });\n    }\n}\n\n// Apply fill, stroke, stroke-width to SVG shape\nfunction styleShape(p) {\n    p\n        .each(function(d) { Color.stroke(d3.select(this), d.line.color);})\n        .each(function(d) { Color.fill(d3.select(this), d.color);})\n        .style('stroke-width', function(d) { return d.line.width;});\n}\n\n// Returns a tween for a transition’s \"d\" attribute, transitioning any selected\n// arcs from their current angle to the specified new angle.\nfunction arcTween(arc, endAngle, newAngle) {\n    return function() {\n        var interp = interpolate(endAngle, newAngle);\n        return function(t) {\n            return arc.endAngle(interp(t))();\n        };\n    };\n}\n\n// mocks our axis\nfunction mockAxis(gd, opts, zrange) {\n    var fullLayout = gd._fullLayout;\n\n    var axisIn = Lib.extendFlat({\n        type: 'linear',\n        ticks: 'outside',\n        range: zrange,\n        showline: true\n    }, opts);\n\n    var axisOut = {\n        type: 'linear',\n        _id: 'x' + opts._id\n    };\n\n    var axisOptions = {\n        letter: 'x',\n        font: fullLayout.font,\n        noAutotickangles: true,\n        noHover: true,\n        noTickson: true\n    };\n\n    function coerce(attr, dflt) {\n        return Lib.coerce(axisIn, axisOut, axisLayoutAttrs, attr, dflt);\n    }\n\n    handleAxisDefaults(axisIn, axisOut, coerce, axisOptions, fullLayout);\n    handleAxisPositionDefaults(axisIn, axisOut, coerce, axisOptions);\n\n    return axisOut;\n}\n\nfunction fitTextInsideBox(textBB, width, height) {\n    // compute scaling ratio to have text fit within specified width and height\n    var ratio = Math.min(width / textBB.width, height / textBB.height);\n    return [ratio, textBB, width + 'x' + height];\n}\n\nfunction fitTextInsideCircle(textBB, radius) {\n    // compute scaling ratio to have text fit within specified radius\n    var elRadius = Math.sqrt((textBB.width / 2) * (textBB.width / 2) + textBB.height * textBB.height);\n    var ratio = radius / elRadius;\n    return [ratio, textBB, radius];\n}\n\nfunction measureText(txt, font, textAnchor, gd) {\n    var element = document.createElementNS('http://www.w3.org/2000/svg', 'text');\n    var sel = d3.select(element);\n    sel.text(txt)\n      .attr('x', 0)\n      .attr('y', 0)\n      .attr('text-anchor', textAnchor)\n      .attr('data-unformatted', txt)\n      .call(svgTextUtils.convertToTspans, gd)\n      .call(Drawing.font, font);\n    return Drawing.bBox(sel.node());\n}\n\nfunction cache(trace, name, initialValue, value, key, fn) {\n    var objName = '_cache' + name;\n    if(!(trace[objName] && trace[objName].key === key)) {\n        trace[objName] = {key: key, value: initialValue};\n    }\n    var v = Lib.aggNums(fn, null, [trace[objName].value, value], 2);\n    trace[objName].value = v;\n\n    return v;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script"}