{"ast":null,"code":"'use strict';\n\nvar Lib = require('../../lib');\nvar strTranslate = Lib.strTranslate;\nvar dragElement = require('../dragelement');\nvar dragHelpers = require('../dragelement/helpers');\nvar drawMode = dragHelpers.drawMode;\nvar selectMode = dragHelpers.selectMode;\nvar Registry = require('../../registry');\nvar Color = require('../color');\nvar constants = require('./draw_newshape/constants');\nvar i000 = constants.i000;\nvar i090 = constants.i090;\nvar i180 = constants.i180;\nvar i270 = constants.i270;\nvar handleOutline = require('./handle_outline');\nvar clearOutlineControllers = handleOutline.clearOutlineControllers;\nvar helpers = require('./draw_newshape/helpers');\nvar pointsOnRectangle = helpers.pointsOnRectangle;\nvar pointsOnEllipse = helpers.pointsOnEllipse;\nvar writePaths = helpers.writePaths;\nvar newShapes = require('./draw_newshape/newshapes').newShapes;\nvar createShapeObj = require('./draw_newshape/newshapes').createShapeObj;\nvar newSelections = require('../selections/draw_newselection/newselections');\nvar drawLabel = require('./display_labels');\nmodule.exports = function displayOutlines(polygons, outlines, dragOptions, nCalls) {\n  if (!nCalls) nCalls = 0;\n  var gd = dragOptions.gd;\n  function redraw() {\n    // recursive call\n    displayOutlines(polygons, outlines, dragOptions, nCalls++);\n    if (pointsOnEllipse(polygons[0]) || dragOptions.hasText) {\n      update({\n        redrawing: true\n      });\n    }\n  }\n  function update(opts) {\n    var updateObject = {};\n    if (dragOptions.isActiveShape !== undefined) {\n      dragOptions.isActiveShape = false; // i.e. to disable shape controllers\n      updateObject = newShapes(outlines, dragOptions);\n    }\n    if (dragOptions.isActiveSelection !== undefined) {\n      dragOptions.isActiveSelection = false; // i.e. to disable selection controllers\n      updateObject = newSelections(outlines, dragOptions);\n      gd._fullLayout._reselect = true;\n    }\n    if (Object.keys(updateObject).length) {\n      Registry.call((opts || {}).redrawing ? 'relayout' : '_guiRelayout', gd, updateObject);\n    }\n  }\n  var fullLayout = gd._fullLayout;\n  var zoomLayer = fullLayout._zoomlayer;\n  var dragmode = dragOptions.dragmode;\n  var isDrawMode = drawMode(dragmode);\n  var isSelectMode = selectMode(dragmode);\n  if (isDrawMode || isSelectMode) {\n    gd._fullLayout._outlining = true;\n  }\n  clearOutlineControllers(gd);\n\n  // make outline\n  outlines.attr('d', writePaths(polygons));\n\n  // add controllers\n  var vertexDragOptions;\n  var groupDragOptions;\n  var indexI; // cell index\n  var indexJ; // vertex or cell-controller index\n  var copyPolygons;\n  if (!nCalls && (dragOptions.isActiveShape || dragOptions.isActiveSelection)) {\n    copyPolygons = recordPositions([], polygons);\n    var g = zoomLayer.append('g').attr('class', 'outline-controllers');\n    addVertexControllers(g);\n    addGroupControllers();\n  }\n\n  // draw label\n  if (isDrawMode && dragOptions.hasText) {\n    var shapeGroup = zoomLayer.select('.label-temp');\n    var shapeOptions = createShapeObj(outlines, dragOptions, dragOptions.dragmode);\n    drawLabel(gd, 'label-temp', shapeOptions, shapeGroup);\n  }\n  function startDragVertex(evt) {\n    indexI = +evt.srcElement.getAttribute('data-i');\n    indexJ = +evt.srcElement.getAttribute('data-j');\n    vertexDragOptions[indexI][indexJ].moveFn = moveVertexController;\n  }\n  function moveVertexController(dx, dy) {\n    if (!polygons.length) return;\n    var x0 = copyPolygons[indexI][indexJ][1];\n    var y0 = copyPolygons[indexI][indexJ][2];\n    var cell = polygons[indexI];\n    var len = cell.length;\n    if (pointsOnRectangle(cell)) {\n      var _dx = dx;\n      var _dy = dy;\n      if (dragOptions.isActiveSelection) {\n        // handle an edge contoller for rect selections\n        var nextPoint = getNextPoint(cell, indexJ);\n        if (nextPoint[1] === cell[indexJ][1]) {\n          // a vertical edge\n          _dy = 0;\n        } else {\n          // a horizontal edge\n          _dx = 0;\n        }\n      }\n      for (var q = 0; q < len; q++) {\n        if (q === indexJ) continue;\n\n        // move other corners of rectangle\n        var pos = cell[q];\n        if (pos[1] === cell[indexJ][1]) {\n          pos[1] = x0 + _dx;\n        }\n        if (pos[2] === cell[indexJ][2]) {\n          pos[2] = y0 + _dy;\n        }\n      }\n      // move the corner\n      cell[indexJ][1] = x0 + _dx;\n      cell[indexJ][2] = y0 + _dy;\n      if (!pointsOnRectangle(cell)) {\n        // reject result to rectangles with ensure areas\n        for (var j = 0; j < len; j++) {\n          for (var k = 0; k < cell[j].length; k++) {\n            cell[j][k] = copyPolygons[indexI][j][k];\n          }\n        }\n      }\n    } else {\n      // other polylines\n      cell[indexJ][1] = x0 + dx;\n      cell[indexJ][2] = y0 + dy;\n    }\n    redraw();\n  }\n  function endDragVertexController() {\n    update();\n  }\n  function removeVertex() {\n    if (!polygons.length) return;\n    if (!polygons[indexI]) return;\n    if (!polygons[indexI].length) return;\n    var newPolygon = [];\n    for (var j = 0; j < polygons[indexI].length; j++) {\n      if (j !== indexJ) {\n        newPolygon.push(polygons[indexI][j]);\n      }\n    }\n    if (newPolygon.length > 1 && !(newPolygon.length === 2 && newPolygon[1][0] === 'Z')) {\n      if (indexJ === 0) {\n        newPolygon[0][0] = 'M';\n      }\n      polygons[indexI] = newPolygon;\n      redraw();\n      update();\n    }\n  }\n  function clickVertexController(numClicks, evt) {\n    if (numClicks === 2) {\n      indexI = +evt.srcElement.getAttribute('data-i');\n      indexJ = +evt.srcElement.getAttribute('data-j');\n      var cell = polygons[indexI];\n      if (!pointsOnRectangle(cell) && !pointsOnEllipse(cell)) {\n        removeVertex();\n      }\n    }\n  }\n  function addVertexControllers(g) {\n    vertexDragOptions = [];\n    for (var i = 0; i < polygons.length; i++) {\n      var cell = polygons[i];\n      var onRect = pointsOnRectangle(cell);\n      var onEllipse = !onRect && pointsOnEllipse(cell);\n      vertexDragOptions[i] = [];\n      var len = cell.length;\n      for (var j = 0; j < len; j++) {\n        if (cell[j][0] === 'Z') continue;\n        if (onEllipse && j !== i000 && j !== i090 && j !== i180 && j !== i270) {\n          continue;\n        }\n        var rectSelection = onRect && dragOptions.isActiveSelection;\n        var nextPoint;\n        if (rectSelection) nextPoint = getNextPoint(cell, j);\n        var x = cell[j][1];\n        var y = cell[j][2];\n        var vertex = g.append(rectSelection ? 'rect' : 'circle').attr('data-i', i).attr('data-j', j).style({\n          fill: Color.background,\n          stroke: Color.defaultLine,\n          'stroke-width': 1,\n          'shape-rendering': 'crispEdges'\n        });\n        if (rectSelection) {\n          // convert a vertex controller to an edge controller for rect selections\n          var dx = nextPoint[1] - x;\n          var dy = nextPoint[2] - y;\n          var width = dy ? 5 : Math.max(Math.min(25, Math.abs(dx) - 5), 5);\n          var height = dx ? 5 : Math.max(Math.min(25, Math.abs(dy) - 5), 5);\n          vertex.classed(dy ? 'cursor-ew-resize' : 'cursor-ns-resize', true).attr('width', width).attr('height', height).attr('x', x - width / 2).attr('y', y - height / 2).attr('transform', strTranslate(dx / 2, dy / 2));\n        } else {\n          vertex.classed('cursor-grab', true).attr('r', 5).attr('cx', x).attr('cy', y);\n        }\n        vertexDragOptions[i][j] = {\n          element: vertex.node(),\n          gd: gd,\n          prepFn: startDragVertex,\n          doneFn: endDragVertexController,\n          clickFn: clickVertexController\n        };\n        dragElement.init(vertexDragOptions[i][j]);\n      }\n    }\n  }\n  function moveGroup(dx, dy) {\n    if (!polygons.length) return;\n    for (var i = 0; i < polygons.length; i++) {\n      for (var j = 0; j < polygons[i].length; j++) {\n        for (var k = 0; k + 2 < polygons[i][j].length; k += 2) {\n          polygons[i][j][k + 1] = copyPolygons[i][j][k + 1] + dx;\n          polygons[i][j][k + 2] = copyPolygons[i][j][k + 2] + dy;\n        }\n      }\n    }\n  }\n  function moveGroupController(dx, dy) {\n    moveGroup(dx, dy);\n    redraw();\n  }\n  function startDragGroupController(evt) {\n    indexI = +evt.srcElement.getAttribute('data-i');\n    if (!indexI) indexI = 0; // ensure non-existing move button get zero index\n\n    groupDragOptions[indexI].moveFn = moveGroupController;\n  }\n  function endDragGroupController() {\n    update();\n  }\n  function clickGroupController(numClicks) {\n    if (numClicks === 2) {\n      eraseActiveSelection(gd);\n    }\n  }\n  function addGroupControllers() {\n    groupDragOptions = [];\n    if (!polygons.length) return;\n    var i = 0;\n    groupDragOptions[i] = {\n      element: outlines[0][0],\n      gd: gd,\n      prepFn: startDragGroupController,\n      doneFn: endDragGroupController,\n      clickFn: clickGroupController\n    };\n    dragElement.init(groupDragOptions[i]);\n  }\n};\nfunction recordPositions(polygonsOut, polygonsIn) {\n  for (var i = 0; i < polygonsIn.length; i++) {\n    var cell = polygonsIn[i];\n    polygonsOut[i] = [];\n    for (var j = 0; j < cell.length; j++) {\n      polygonsOut[i][j] = [];\n      for (var k = 0; k < cell[j].length; k++) {\n        polygonsOut[i][j][k] = cell[j][k];\n      }\n    }\n  }\n  return polygonsOut;\n}\nfunction getNextPoint(cell, j) {\n  var x = cell[j][1];\n  var y = cell[j][2];\n  var len = cell.length;\n  var nextJ, nextX, nextY;\n  nextJ = (j + 1) % len;\n  nextX = cell[nextJ][1];\n  nextY = cell[nextJ][2];\n\n  // avoid potential double points (closing points)\n  if (nextX === x && nextY === y) {\n    nextJ = (j + 2) % len;\n    nextX = cell[nextJ][1];\n    nextY = cell[nextJ][2];\n  }\n  return [nextJ, nextX, nextY];\n}\nfunction eraseActiveSelection(gd) {\n  // Do not allow removal of selections on other dragmodes.\n  // This ensures the user could still double click to\n  // deselect all trace.selectedpoints,\n  // if that's what they wanted.\n  // Also double click to zoom back won't result in\n  // any surprising selection removal.\n  if (!selectMode(gd._fullLayout.dragmode)) return;\n  clearOutlineControllers(gd);\n  var id = gd._fullLayout._activeSelectionIndex;\n  var selections = (gd.layout || {}).selections || [];\n  if (id < selections.length) {\n    var list = [];\n    for (var q = 0; q < selections.length; q++) {\n      if (q !== id) {\n        list.push(selections[q]);\n      }\n    }\n    delete gd._fullLayout._activeSelectionIndex;\n    var erasedSelection = gd._fullLayout.selections[id];\n    gd._fullLayout._deselect = {\n      xref: erasedSelection.xref,\n      yref: erasedSelection.yref\n    };\n    Registry.call('_guiRelayout', gd, {\n      selections: list\n    });\n  }\n}","map":{"version":3,"names":["Lib","require","strTranslate","dragElement","dragHelpers","drawMode","selectMode","Registry","Color","constants","i000","i090","i180","i270","handleOutline","clearOutlineControllers","helpers","pointsOnRectangle","pointsOnEllipse","writePaths","newShapes","createShapeObj","newSelections","drawLabel","module","exports","displayOutlines","polygons","outlines","dragOptions","nCalls","gd","redraw","hasText","update","redrawing","opts","updateObject","isActiveShape","undefined","isActiveSelection","_fullLayout","_reselect","Object","keys","length","call","fullLayout","zoomLayer","_zoomlayer","dragmode","isDrawMode","isSelectMode","_outlining","attr","vertexDragOptions","groupDragOptions","indexI","indexJ","copyPolygons","recordPositions","g","append","addVertexControllers","addGroupControllers","shapeGroup","select","shapeOptions","startDragVertex","evt","srcElement","getAttribute","moveFn","moveVertexController","dx","dy","x0","y0","cell","len","_dx","_dy","nextPoint","getNextPoint","q","pos","j","k","endDragVertexController","removeVertex","newPolygon","push","clickVertexController","numClicks","i","onRect","onEllipse","rectSelection","x","y","vertex","style","fill","background","stroke","defaultLine","width","Math","max","min","abs","height","classed","element","node","prepFn","doneFn","clickFn","init","moveGroup","moveGroupController","startDragGroupController","endDragGroupController","clickGroupController","eraseActiveSelection","polygonsOut","polygonsIn","nextJ","nextX","nextY","id","_activeSelectionIndex","selections","layout","list","erasedSelection","_deselect","xref","yref"],"sources":["E:/tog_workspace/TestFabric_main/TestFabric-main/node_modules/plotly.js/src/components/shapes/display_outlines.js"],"sourcesContent":["'use strict';\n\nvar Lib = require('../../lib');\nvar strTranslate = Lib.strTranslate;\n\nvar dragElement = require('../dragelement');\nvar dragHelpers = require('../dragelement/helpers');\nvar drawMode = dragHelpers.drawMode;\nvar selectMode = dragHelpers.selectMode;\n\nvar Registry = require('../../registry');\nvar Color = require('../color');\n\nvar constants = require('./draw_newshape/constants');\nvar i000 = constants.i000;\nvar i090 = constants.i090;\nvar i180 = constants.i180;\nvar i270 = constants.i270;\n\nvar handleOutline = require('./handle_outline');\nvar clearOutlineControllers = handleOutline.clearOutlineControllers;\n\nvar helpers = require('./draw_newshape/helpers');\nvar pointsOnRectangle = helpers.pointsOnRectangle;\nvar pointsOnEllipse = helpers.pointsOnEllipse;\nvar writePaths = helpers.writePaths;\nvar newShapes = require('./draw_newshape/newshapes').newShapes;\nvar createShapeObj = require('./draw_newshape/newshapes').createShapeObj;\nvar newSelections = require('../selections/draw_newselection/newselections');\nvar drawLabel = require('./display_labels');\n\n\nmodule.exports = function displayOutlines(polygons, outlines, dragOptions, nCalls) {\n    if(!nCalls) nCalls = 0;\n\n    var gd = dragOptions.gd;\n\n    function redraw() {\n        // recursive call\n        displayOutlines(polygons, outlines, dragOptions, nCalls++);\n\n        if(pointsOnEllipse(polygons[0]) || dragOptions.hasText) {\n            update({redrawing: true});\n        }\n    }\n\n    function update(opts) {\n        var updateObject = {};\n\n        if(dragOptions.isActiveShape !== undefined) {\n            dragOptions.isActiveShape = false; // i.e. to disable shape controllers\n            updateObject = newShapes(outlines, dragOptions);\n        }\n\n        if(dragOptions.isActiveSelection !== undefined) {\n            dragOptions.isActiveSelection = false; // i.e. to disable selection controllers\n            updateObject = newSelections(outlines, dragOptions);\n\n            gd._fullLayout._reselect = true;\n        }\n\n        if(Object.keys(updateObject).length) {\n            Registry.call((opts || {}).redrawing ? 'relayout' : '_guiRelayout', gd, updateObject);\n        }\n    }\n\n    var fullLayout = gd._fullLayout;\n    var zoomLayer = fullLayout._zoomlayer;\n\n    var dragmode = dragOptions.dragmode;\n    var isDrawMode = drawMode(dragmode);\n    var isSelectMode = selectMode(dragmode);\n\n    if(isDrawMode || isSelectMode) {\n        gd._fullLayout._outlining = true;\n    }\n\n    clearOutlineControllers(gd);\n\n    // make outline\n    outlines.attr('d', writePaths(polygons));\n\n    // add controllers\n    var vertexDragOptions;\n    var groupDragOptions;\n    var indexI; // cell index\n    var indexJ; // vertex or cell-controller index\n    var copyPolygons;\n\n    if(!nCalls && (\n        dragOptions.isActiveShape ||\n        dragOptions.isActiveSelection\n    )) {\n        copyPolygons = recordPositions([], polygons);\n\n        var g = zoomLayer.append('g').attr('class', 'outline-controllers');\n        addVertexControllers(g);\n        addGroupControllers();\n    }\n\n    // draw label\n    if(isDrawMode && dragOptions.hasText) {\n        var shapeGroup = zoomLayer.select('.label-temp');\n        var shapeOptions = createShapeObj(outlines, dragOptions, dragOptions.dragmode);\n        drawLabel(gd, 'label-temp', shapeOptions, shapeGroup);\n    }\n\n    function startDragVertex(evt) {\n        indexI = +evt.srcElement.getAttribute('data-i');\n        indexJ = +evt.srcElement.getAttribute('data-j');\n\n        vertexDragOptions[indexI][indexJ].moveFn = moveVertexController;\n    }\n\n    function moveVertexController(dx, dy) {\n        if(!polygons.length) return;\n\n        var x0 = copyPolygons[indexI][indexJ][1];\n        var y0 = copyPolygons[indexI][indexJ][2];\n\n        var cell = polygons[indexI];\n        var len = cell.length;\n        if(pointsOnRectangle(cell)) {\n            var _dx = dx;\n            var _dy = dy;\n            if(dragOptions.isActiveSelection) {\n                // handle an edge contoller for rect selections\n                var nextPoint = getNextPoint(cell, indexJ);\n                if(nextPoint[1] === cell[indexJ][1]) { // a vertical edge\n                    _dy = 0;\n                } else { // a horizontal edge\n                    _dx = 0;\n                }\n            }\n\n            for(var q = 0; q < len; q++) {\n                if(q === indexJ) continue;\n\n                // move other corners of rectangle\n                var pos = cell[q];\n\n                if(pos[1] === cell[indexJ][1]) {\n                    pos[1] = x0 + _dx;\n                }\n\n                if(pos[2] === cell[indexJ][2]) {\n                    pos[2] = y0 + _dy;\n                }\n            }\n            // move the corner\n            cell[indexJ][1] = x0 + _dx;\n            cell[indexJ][2] = y0 + _dy;\n\n            if(!pointsOnRectangle(cell)) {\n                // reject result to rectangles with ensure areas\n                for(var j = 0; j < len; j++) {\n                    for(var k = 0; k < cell[j].length; k++) {\n                        cell[j][k] = copyPolygons[indexI][j][k];\n                    }\n                }\n            }\n        } else { // other polylines\n            cell[indexJ][1] = x0 + dx;\n            cell[indexJ][2] = y0 + dy;\n        }\n\n        redraw();\n    }\n\n    function endDragVertexController() {\n        update();\n    }\n\n    function removeVertex() {\n        if(!polygons.length) return;\n        if(!polygons[indexI]) return;\n        if(!polygons[indexI].length) return;\n\n        var newPolygon = [];\n        for(var j = 0; j < polygons[indexI].length; j++) {\n            if(j !== indexJ) {\n                newPolygon.push(\n                    polygons[indexI][j]\n                );\n            }\n        }\n\n        if(newPolygon.length > 1 && !(\n            newPolygon.length === 2 && newPolygon[1][0] === 'Z')\n        ) {\n            if(indexJ === 0) {\n                newPolygon[0][0] = 'M';\n            }\n\n            polygons[indexI] = newPolygon;\n\n            redraw();\n            update();\n        }\n    }\n\n    function clickVertexController(numClicks, evt) {\n        if(numClicks === 2) {\n            indexI = +evt.srcElement.getAttribute('data-i');\n            indexJ = +evt.srcElement.getAttribute('data-j');\n\n            var cell = polygons[indexI];\n            if(\n                !pointsOnRectangle(cell) &&\n                !pointsOnEllipse(cell)\n            ) {\n                removeVertex();\n            }\n        }\n    }\n\n    function addVertexControllers(g) {\n        vertexDragOptions = [];\n\n        for(var i = 0; i < polygons.length; i++) {\n            var cell = polygons[i];\n\n            var onRect = pointsOnRectangle(cell);\n            var onEllipse = !onRect && pointsOnEllipse(cell);\n\n            vertexDragOptions[i] = [];\n            var len = cell.length;\n            for(var j = 0; j < len; j++) {\n                if(cell[j][0] === 'Z') continue;\n\n                if(onEllipse &&\n                    j !== i000 &&\n                    j !== i090 &&\n                    j !== i180 &&\n                    j !== i270\n                ) {\n                    continue;\n                }\n\n                var rectSelection = onRect && dragOptions.isActiveSelection;\n                var nextPoint;\n                if(rectSelection) nextPoint = getNextPoint(cell, j);\n\n                var x = cell[j][1];\n                var y = cell[j][2];\n\n                var vertex = g.append(rectSelection ? 'rect' : 'circle')\n                    .attr('data-i', i)\n                    .attr('data-j', j)\n                    .style({\n                        fill: Color.background,\n                        stroke: Color.defaultLine,\n                        'stroke-width': 1,\n                        'shape-rendering': 'crispEdges',\n                    });\n\n                if(rectSelection) {\n                    // convert a vertex controller to an edge controller for rect selections\n                    var dx = nextPoint[1] - x;\n                    var dy = nextPoint[2] - y;\n\n                    var width = dy ? 5 : Math.max(Math.min(25, Math.abs(dx) - 5), 5);\n                    var height = dx ? 5 : Math.max(Math.min(25, Math.abs(dy) - 5), 5);\n\n                    vertex.classed(dy ? 'cursor-ew-resize' : 'cursor-ns-resize', true)\n                        .attr('width', width)\n                        .attr('height', height)\n                        .attr('x', x - width / 2)\n                        .attr('y', y - height / 2)\n                        .attr('transform', strTranslate(dx / 2, dy / 2));\n                } else {\n                    vertex.classed('cursor-grab', true)\n                        .attr('r', 5)\n                        .attr('cx', x)\n                        .attr('cy', y);\n                }\n\n                vertexDragOptions[i][j] = {\n                    element: vertex.node(),\n                    gd: gd,\n                    prepFn: startDragVertex,\n                    doneFn: endDragVertexController,\n                    clickFn: clickVertexController\n                };\n\n                dragElement.init(vertexDragOptions[i][j]);\n            }\n        }\n    }\n\n    function moveGroup(dx, dy) {\n        if(!polygons.length) return;\n\n        for(var i = 0; i < polygons.length; i++) {\n            for(var j = 0; j < polygons[i].length; j++) {\n                for(var k = 0; k + 2 < polygons[i][j].length; k += 2) {\n                    polygons[i][j][k + 1] = copyPolygons[i][j][k + 1] + dx;\n                    polygons[i][j][k + 2] = copyPolygons[i][j][k + 2] + dy;\n                }\n            }\n        }\n    }\n\n    function moveGroupController(dx, dy) {\n        moveGroup(dx, dy);\n\n        redraw();\n    }\n\n    function startDragGroupController(evt) {\n        indexI = +evt.srcElement.getAttribute('data-i');\n        if(!indexI) indexI = 0; // ensure non-existing move button get zero index\n\n        groupDragOptions[indexI].moveFn = moveGroupController;\n    }\n\n    function endDragGroupController() {\n        update();\n    }\n\n    function clickGroupController(numClicks) {\n        if(numClicks === 2) {\n            eraseActiveSelection(gd);\n        }\n    }\n\n    function addGroupControllers() {\n        groupDragOptions = [];\n\n        if(!polygons.length) return;\n\n        var i = 0;\n        groupDragOptions[i] = {\n            element: outlines[0][0],\n            gd: gd,\n            prepFn: startDragGroupController,\n            doneFn: endDragGroupController,\n            clickFn: clickGroupController\n        };\n\n        dragElement.init(groupDragOptions[i]);\n    }\n};\n\nfunction recordPositions(polygonsOut, polygonsIn) {\n    for(var i = 0; i < polygonsIn.length; i++) {\n        var cell = polygonsIn[i];\n        polygonsOut[i] = [];\n        for(var j = 0; j < cell.length; j++) {\n            polygonsOut[i][j] = [];\n            for(var k = 0; k < cell[j].length; k++) {\n                polygonsOut[i][j][k] = cell[j][k];\n            }\n        }\n    }\n    return polygonsOut;\n}\n\nfunction getNextPoint(cell, j) {\n    var x = cell[j][1];\n    var y = cell[j][2];\n    var len = cell.length;\n    var nextJ, nextX, nextY;\n    nextJ = (j + 1) % len;\n    nextX = cell[nextJ][1];\n    nextY = cell[nextJ][2];\n\n    // avoid potential double points (closing points)\n    if(nextX === x && nextY === y) {\n        nextJ = (j + 2) % len;\n        nextX = cell[nextJ][1];\n        nextY = cell[nextJ][2];\n    }\n\n    return [nextJ, nextX, nextY];\n}\n\nfunction eraseActiveSelection(gd) {\n    // Do not allow removal of selections on other dragmodes.\n    // This ensures the user could still double click to\n    // deselect all trace.selectedpoints,\n    // if that's what they wanted.\n    // Also double click to zoom back won't result in\n    // any surprising selection removal.\n    if(!selectMode(gd._fullLayout.dragmode)) return;\n\n    clearOutlineControllers(gd);\n\n    var id = gd._fullLayout._activeSelectionIndex;\n    var selections = (gd.layout || {}).selections || [];\n    if(id < selections.length) {\n        var list = [];\n        for(var q = 0; q < selections.length; q++) {\n            if(q !== id) {\n                list.push(selections[q]);\n            }\n        }\n\n        delete gd._fullLayout._activeSelectionIndex;\n\n        var erasedSelection = gd._fullLayout.selections[id];\n        gd._fullLayout._deselect = {\n            xref: erasedSelection.xref,\n            yref: erasedSelection.yref\n        };\n\n        Registry.call('_guiRelayout', gd, {\n            selections: list\n        });\n    }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script"}